<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CTP Data Model and API, rev. 2.13</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden] { display: none; }
html { background: #fff; color: #000; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: none; border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="article">
<div id="header">
<h1>CTP Data Model and API, rev. 2.13</h1>
<span id="author" class="author">Cloud Security Alliance</span><br>
<span id="revnumber">version 2.13,</span>
<span id="revdate">October 2015</span>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_revision_history">Revision history</a></li>
<li><a href="#_acknowledgments">Acknowledgments</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_lead_author">Lead author</a></li>
<li><a href="#_reviewers_and_contributors">Reviewers and contributors</a></li>
<li><a href="#_european_research_project_support">European research project support</a></li>
</ul>
</li>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#terms-and-definitions">2. Terms and definitions</a></li>
<li><a href="#overview-of-ctp">3. Overview of CTP</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#principles-of-the-ctp-api">3.1. Principles of the CTP API</a></li>
<li><a href="#introducing-the-ctp-data-model">3.2. Introducing the CTP data model</a></li>
</ul>
</li>
<li><a href="#the-ctp-data-model">4. The CTP Data Model</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#json-representation">4.1. JSON representation</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#api-resources-urls">4.1.1. API Resources URLs and identifiers</a></li>
<li><a href="#_resource_urls">4.1.2. Resource URLs</a></li>
<li><a href="#identifiers">4.1.3. Identifiers</a></li>
<li><a href="#json-notations-used-in-the-specification">4.1.4. JSON notations used in the specification</a></li>
<li><a href="#common-properties-of-ctp-json-objects">4.1.5. Common properties of CTP JSON objects</a></li>
<li><a href="#collections">4.1.6. Collections</a></li>
</ul>
</li>
<li><a href="#resources">4.2. Resources</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#ctpbase">4.2.1. CTP entry point (CtpBase)</a></li>
<li><a href="#service-views">4.2.2. Service-views</a></li>
<li><a href="#assets">4.2.3. Assets</a></li>
<li><a href="#attributes">4.2.4. Attributes</a></li>
<li><a href="#metrics">4.2.5. Metrics</a></li>
<li><a href="#measurements">4.2.6. Measurements</a></li>
<li><a href="#triggers">4.2.7. Triggers</a></li>
<li><a href="#log-entries">4.2.8. Log entries</a></li>
</ul>
</li>
<li><a href="#classes">4.3. Service classes and asset classes</a></li>
<li><a href="#relating-measurement-results-and-metrics">4.4. Relating measurement results and metrics</a></li>
</ul>
</li>
<li><a href="#the-api">5. The API</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#application-of-restful-principles">5.1. Application of RESTful principles</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_http_methods">5.1.1. HTTP methods</a></li>
<li><a href="#application-of-hateoas">5.1.2. Application of HATEOAS</a></li>
<li><a href="#content-type">5.1.3. Content type</a></li>
<li><a href="#status-codes">5.1.4. Status codes</a></li>
<li><a href="#error-response-bodies">5.1.5. Error response bodies</a></li>
</ul>
</li>
<li><a href="#specification-of-the-api-calls">5.2. Specification of the API calls</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#get-ctpbase">5.2.1. GET {CtpBase}</a></li>
<li><a href="#get-serviceviews">5.2.2. GET {CtpBase}/serviceViews</a></li>
<li><a href="#get-serviceunits-id">5.2.3. GET {CtpBase}/serviceViews/{id}</a></li>
<li><a href="#get-serviceunits-id-dependencies">5.2.4. GET {CtpBase}/serviceViews/{id}/dependencies</a></li>
<li><a href="#get-serviceunits-id-assets">5.2.5. GET {CtpBase}/serviceViews/{id}/assets</a></li>
<li><a href="#get-assets-id">5.2.6. GET {CtpBase}/assets/{id}</a></li>
<li><a href="#get-assets-id-attributes">5.2.7. GET {CtpBase}/assets/{id}/attributes</a></li>
<li><a href="#get-attributes-id">5.2.8. GET {CtpBase}/attributes/{id}</a></li>
<li><a href="#get-attributes-id-measurements">5.2.9. GET {CtpBase}/attributes/{id}/measurements</a></li>
<li><a href="#get-measurements-id">5.2.10. GET {CtpBase}/measurements/{id}</a></li>
<li><a href="#put-measurements-id-state">5.2.11. PUT {CtpBase}/measurements/{id}?x=state`</a></li>
<li><a href="#get-metrics">5.2.12. GET {CtpBase}/metrics</a></li>
<li><a href="#get-metrics-id">5.2.13. GET {CtpBase}/metrics/{id}</a></li>
<li><a href="#get-views-id-triggers">5.2.14. GET {CtpBase}/serviceViews/{id}/triggers</a></li>
<li><a href="#get-triggers-id">5.2.15. GET {CtpBase}/triggers/{id}</a></li>
<li><a href="#post-views-id-triggers">5.2.16. POST {CtpBase}/serviceViews/{id}/triggers</a></li>
<li><a href="#delete-triggers-id">5.2.17. DELETE {CtpBase}/triggers/{id}</a></li>
<li><a href="#get-views-id-logs">5.2.18. GET {CtpBase}/serviceViews/{id}/logs</a></li>
<li><a href="#get-logs-id">5.2.19. GET {CtpBase}/logs/{id}</a></li>
</ul>
</li>
<li><a href="#evaluating-triggers-and-objectives">5.3. Evaluating triggers and objectives</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#evaluating-objectives">5.3.1. Evaluating objectives</a></li>
<li><a href="#evaluating-triggers">5.3.2. Evaluating triggers</a></li>
</ul>
</li>
<li><a href="#ctpscript">5.4. CTPScript: a condition description language</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#basic-grammar">5.4.1. Basic Grammar</a></li>
<li><a href="#definitions-borrowed-from-other-standards">5.4.2. Definitions borrowed from other standards</a></li>
<li><a href="#types">5.4.3. Types</a></li>
<li><a href="#functions">5.4.4. Functions</a></li>
<li><a href="#boolean-operators">5.4.5. Boolean operators ||, &amp;&amp;</a></li>
<li><a href="#comparison-operators">5.4.6. Comparison Operators &lt;, &lt;=, &gt;, &gt;=, ==, !=</a></li>
<li><a href="#multiplicative-and-additive-binary-operators">5.4.7. Multiplicative and additive binary operators: +, -, *, /, %</a></li>
<li><a href="#ctpscript-identifiers">5.4.8. Identifiers</a></li>
<li><a href="#evaluating-ctpscript-expressions">5.4.9. Evaluating CTPScript expressions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security-considerations">6. Security considerations</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#four-security-requirements-for-the-ctp-api">6.1. Four security requirements for the CTP API</a></li>
<li><a href="#example-of-solutions">6.2. Example of solutions</a></li>
<li><a href="#recommended-security-mechanisms">6.3. Recommended security mechanisms</a></li>
</ul>
</li>
<li><a href="#api-examples">7. Appendix A: API Examples</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#step-1">7.1. Step 1: Connecting to the entry point of the CTP server</a></li>
<li><a href="#step-2">7.2. Step 2: Discovering the service-views accessible to the customer</a></li>
<li><a href="#step-3">7.3. Step 3: Accessing information on the service-view</a></li>
<li><a href="#step-4">7.4. Step 4: Discovering the list of assets of the service-view</a></li>
<li><a href="#step-5">7.5. Step 5: Discovering the details of the first asset of the service-view</a></li>
<li><a href="#step-6">7.6. Step 8: Discovering the list of security attributes of the asset</a></li>
<li><a href="#step-7">7.7. Step 7: Discovering the details of the second security attribute of the asset</a></li>
<li><a href="#step-8">7.8. Step 8: Discovering the list of measurements available for this attribute.</a></li>
<li><a href="#step-9">7.9. Step 9: Discovering the details of the first measurement available for the selected security attribute</a></li>
<li><a href="#step-10">7.10. Step 10: Getting information about the metric used in the measurement</a></li>
</ul>
</li>
<li><a href="#supply-chain">8. Appendix B: Accessing information about the supply chain</a></li>
<li><a href="#ctp-project-history">9. Appendix C: CTP project history</a></li>
<li><a href="#references">10. References</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_revision_history">Revision history</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:10%;">
<col style="width:20%;">
<col style="width:70%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Revision</strong></th>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Comment</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oct. 2012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First draft / brainstorming document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov. 2012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complete model change. Evolution to a draft standard.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dec. 2012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Model update.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jan 15, 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transition from Google Doc to Microsoft Word format.<br>
                             First release for expert review.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feb 4, 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minor changes to emphasize optional “service classes”.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">May 8, 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clarification and minor changes based on expert review feedback.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">June 15, 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removed resource-group abstraction in the data model.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July 3, 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clarification and minor changes based on internal feedback.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov. 25, 2014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major revision after creation of Cloud Trust working group and feedback from the past 12 months.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jan. 20, 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Revision after internal review and before wider release to research community outside CSA.
                             The API was switched from XML to JSON, to acknowledge current trends in
                             cloud API development and adopt a more agile approach.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">June 30, 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major revision after open public review.
                             Abandoned MS Word for more professional tools dedicated to technical documentation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July 16, 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Homogenize common attributes in CTP resources.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sep. 9, 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simplification of the data model and change in the format of items in collections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oct. 6, 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added <em>status</em> and <em>statusUpdateTime</em> to triggers</p></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect1">
<h2 id="_acknowledgments">Acknowledgments</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_lead_author">Lead author</h3>
<div class="paragraph">
<p>Alain Pannetrat – <a href="mailto:apannetrat@cloudsecurityalliance.org">apannetrat@cloudsecurityalliance.org</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_reviewers_and_contributors">Reviewers and contributors</h3>
<div class="paragraph">
<p>Bernd Jaeger</p>
</div>
<div class="paragraph">
<p>Giles Hogben</p>
</div>
<div class="paragraph">
<p>Jesus Luna</p>
</div>
<div class="paragraph">
<p>Konstantinos Mantzoukas</p>
</div>
<div class="paragraph">
<p>Laura Lindsay</p>
</div>
<div class="paragraph">
<p>Martin Gilje Jaatun</p>
</div>
<div class="paragraph">
<p>Massimiliano Rak</p>
</div>
<div class="paragraph">
<p>Mauro Turtur</p>
</div>
<div class="paragraph">
<p>Michaela Iorga</p>
</div>
<div class="paragraph">
<p>Michela D&#8217;Errico</p>
</div>
<div class="paragraph">
<p>Ronald Tse</p>
</div>
</div>
<div class="sect2">
<h3 id="_european_research_project_support">European research project support</h3>
<div class="paragraph">
<p>A4Cloud - <a href="http://www.a4cloud.eu/">http://www.a4cloud.eu/</a></p>
</div>
<div class="paragraph">
<p>CUMULUS - <a href="http://www.cumulus-project.eu/">http://www.cumulus-project.eu/</a></p>
</div>
<div class="paragraph">
<p>SPECS - <a href="http://www.specs-project.eu/">http://www.specs-project.eu/</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Cloud Trust Protocol (CTP) is designed to be a mechanism by which
cloud service customers can ask for and receive information related to
the security of the services they use in the cloud, promoting
transparency and trust.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Why CTP?</div>
<div class="paragraph">
<p>The creation of CTP was motivated by the current gaps in cloud security
monitoring.
Though many cloud providers offer solutions such as dashboards or
ad-hoc APIs in order to enable cloud customers to monitor cloud
services, these solutions have some strong shortcomings when
it comes to the security of cloud services. First, they are
usually proprietary and not interoperable. Second, they often target
performance indicators rather than security. Third, the measurements
conducted by providers are often imprecisely described in terms of
parameters and scope. Fourth, each provider typically uses subtlety
different metrics for similar attributes, thus making any comparison
with a customer-defined baseline challenging while additionally making
the ranking of competing services near impossible. The API described in
this document aims to solve the first and third issues, while creating
a platform tailored to support a solution to the other
two remaining issues, which will require further standardization
initiatives by relevant stakeholder.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This document focuses on the definition of the CTP Data Model and
Application Programing Interface (API), including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The format of CTP messages exchanged between cloud service customers
and providers.</p>
</li>
<li>
<p>The modeling of concepts such as “security attributes”, “objectives”,
“measurement results” and “triggers” in machine readable format.</p>
</li>
<li>
<p>The means to define the scope of the service to which CTP monitoring
queries apply.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, this document does not provide a specification of the “security
attributes” (and associated metrics) that are queried by CTP. Such a
specification will be provided by the Cloud Security Alliance in a
separate document, and will likely be influenced by upcoming standards
such as <a href="#ISO_19086">[ISO_19086]</a>. CTP also offers implementers the choice to define
and adopt their own set of security attributes and related metrics.</p>
</div>
<div class="paragraph">
<p>This document is organized as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#terms-and-definitions">Section 2</a> provides some key <strong>terms and definitions</strong> that are used
throughout this document, borrowing from relevant key standards.</p>
</li>
<li>
<p><a href="#overview-of-ctp">Section 3</a> offers a general introductory <strong>overview of CTP</strong>.</p>
</li>
<li>
<p><a href="#the-ctp-data-model">Section 4</a> describes the <strong>CTP data model</strong>, defining the main
concepts that are used to represent security information related to
cloud services in CTP.</p>
</li>
<li>
<p><a href="#the-api">Section 5</a> specifies the <strong>RESTful CTP API</strong> that implements the model
described in section 4. It also specifies the CTPScript language used
in “triggers” and “objectives” and describes when they should be
evaluated.</p>
</li>
<li>
<p><a href="#security-considerations">section 6</a> provides requirements and recommendations for securing the
CTP API.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The document concludes with an <strong>appendix</strong>, which offers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <a href="#api-examples">example</a> of a message-level dialogue between a CTP client and a CTP server.</p>
</li>
<li>
<p>Information on the use of CTP <a href="#supply-chain">across a supply chain</a>, where one
cloud provider offering CTP uses other sub-providers that also implement
CTP.</p>
</li>
<li>
<p>A brief overview of the <a href="#ctp-project-history">CTP project history</a> and the changes
introduced since the previous version of the CTP model published in
2011.</p>
</li>
<li>
<p>External <a href="#references">References</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terms-and-definitions">2. Terms and definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section we provide some key terms and definitions used in the
CTP API, which mostly originate from ISO/IEC <a href="#ISO_27000">[ISO 27000]</a>, with a few
additions from other relevant sources.</p>
</div>
<div class="paragraph">
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a href="#RFC_2119">[RFC_2119]</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
This document does not use the term &#8220;<strong>measure</strong>&#8221; proposed
in <a href="#ISO_27000">[ISO_27000]</a> to avoid potential confusion arising from the multiple
conflicting uses of this term, as highlighted in <a href="#NIST">[NIST]</a>.
</td>
</tr>
</table>
</div>
<div class="dlist glossary">
<dl>
<dt>Asset</dt>
<dd>
<p><a id="asset"></a> An asset is any tangible or intangible component of an information system that <em>has value to an organization</em> (source: derived from ISO/IEC IS 13335-1 and <a href="#ENISA">[ENISA]</a>).</p>
</dd>
<dt>Attribute</dt>
<dd>
<p><a id="attribute"></a> An attribute is <em>a property or characteristic of an object that can be distinguished quantitatively or qualitatively by human or automated means</em> (source: <a href="#ISO_27000">ISO/IEC 27000:2014</a> from ISO/IEC 15939:2007).</p>
</dd>
<dt>Security attribute</dt>
<dd>
<p>A security attribute is an attribute that describes a property related to confidentiality, integrity or availability.</p>
</dd>
<dt>Measurement</dt>
<dd>
<p><a id="measurement"></a> A measurement is a <em>process to determine a value</em> (source: <a href="#ISO_27000">ISO/IEC 27000:2014</a>). In this document, a measurement describes the process resulting in the production of a <em>measurement result</em>, which is the evaluation of the value of an attribute.</p>
</dd>
<dt>Measurement parameter</dt>
<dd>
<p><a id="measurement-parameter"></a> A measurement parameter is a variable representing a characteristic of the measurement process.</p>
</dd>
<dt>Measurement parameter value</dt>
<dd>
<p><a id="measurement-parameter-value"></a> A measurement parameter value describes the value assigned to a measurement parameter.</p>
</dd>
<dt>Measurement result</dt>
<dd>
<p><a id="measurement-result"></a> A measurement result <em>is a value that expresses a qualitative or quantitative assessment of</em> an attribute. (Based on both <a href="#NIST">[NIST]</a> and <a href="#ISO_27000">ISO/IEC 27000:2014</a> from 15939:2007).</p>
</dd>
<dt>Metric</dt>
<dd>
<p><a id="metric"></a> A metric is <em>a standard of measurement that defines the conditions and the rules for performing the measurement and for understanding the results of a measurement</em>. (source: <a href="#NIST">[NIST]</a>)</p>
</dd>
<dt>Objective</dt>
<dd>
<p><a id="objective"></a> An objective is defined as <em>a result to be achieved</em>. (source: <a href="#ISO_27000">ISO/IEC 27000:2014</a>).
In this document an <em>objective</em> describes more specifically the <em>measurement results</em> that should be achieved in order to represent a desired level of security.</p>
</dd>
<dt>CTP Client</dt>
<dd>
<p><a id="ctp-client"></a> A CTP client is a software client that uses the CTP API to make queries and receive responses from a CTP Server.</p>
</dd>
<dt>CTP Server</dt>
<dd>
<p><a id="ctp-server"></a> A CTP server is a software server that implements the CTP API in order to describe the level of security of a cloud system to CTP clients, in near real-time, through a set of attributes.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-of-ctp">3. Overview of CTP</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="principles-of-the-ctp-api">3.1. Principles of the CTP API</h3>
<div class="paragraph">
<p>The CTP API is designed to be a RESTful <span class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</span>
protocol that cloud service customers can use to query a cloud service
provider (CSP) on current security attributes related to a cloud service
such as the current level of availability of the service or information
on the last vulnerability assessment. This is normally done through a classical
query-response approach driven by the customer. CTP also enables customers
to define &#8220;triggers&#8221; in order to receive alerts when specific conditions
are met, through a standard XMPP-based notification mechanism.
The CTP API additionally provides access to a log facility that
can be used to store and access security events generated by triggers.</p>
</div>
<div class="paragraph">
<p>It is important to emphasize that CTP mainly proposes a unified
standardized API to present measurement results related to cloud
security. As such, the CTP API does not cover the actual monitoring
infrastructure and related technologies that are used to gather, store
and analyze events in order to produce these measurement results.</p>
</div>
<div class="paragraph">
<p>The following diagrams provide a general idea of the principles of CTP
through 3 simple use cases where a cloud service customer uses CTP to
query a cloud service provider about security attributes of its
services. In the first figure (<strong>A</strong>), the cloud service customer uses
CTP to query a cloud service provider about the service availability level that
it is committed to provide. In CTP the result of this query
is called an “objective”&#8201;&#8212;&#8201;or “service level objective”&#8201;&#8212;&#8201;since it describes what the provider aims to achieve, as typically
described in an SLA.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="media/example_A.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Next, in figure (<strong>B</strong>), the cloud service customer queries the cloud
provider about the service availability level that was actually achieved
in the past month. The result of this query is called a
“measurement result” in CTP, since it describes the result of a service
level measurement reported by the cloud provider. Both this measurement
result and the objective in the previous example apply to the same
security attribute informally called “availability” here.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="media/example_B.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Finally, in figure (<strong>C</strong>), the cloud service customer asks the cloud
provider to send an alert when a specific condition is verified. This is
called a “trigger” in CTP. In addition, the cloud provider will
also log the details of this alert locally for future consultation by
the customer.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="media/example_C.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>Naturally, these examples leave out a lot of details that need to be
addressed in CTP. Readers interested in “concrete” examples of CTP
message exchanges may look at <a href="#api-examples">API Examples</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="introducing-the-ctp-data-model">3.2. Introducing the CTP data model</h3>
<div class="paragraph">
<p>In order to implement the principles of the CTP API outlined in the
previous paragraphs, it is necessary to define a data model that
represents security attributes and related information through a set of
objects that can be queried by CTP clients (e.g. cloud service
customers).</p>
</div>
<div class="paragraph">
<p>Because CSPs offer very different kinds of services, they will use
different approaches to describe their systems and the security they
offer to cloud service customers. For example, an IaaS provider may
present its service to the customer as a distinct set of “compute”,
“storage” and “network” services. A SaaS provider might take a more
abstract approach and simply present the service as a web service API
available from a URL (much like CTP itself) with a set of security
objectives associated with each functionality. The service presented to
the customer is often a composition of several distinct services
presented as one unique service associated with a clearly defined set of
security objectives specified in a service interface and/or SLA.</p>
</div>
<div class="paragraph">
<p>In order to address such a wide range of use-cases, CTP takes an agnostic approach to
the underlying technology and deployment model of a cloud, and adopts a
data model that is based on the following 3 hierarchical components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Service-Views</strong>: A service-view represents a customer&#8217;s view of a
cloud service provided under the responsibility of a designated provider.
In the most common case, from the perspective of a customer, there will be a
1-to-1 mapping between what is called a “cloud service” and a service-view.
However in more complex use-cases it can be useful to break down a “cloud
service” into a set of distinct service-views, each potentially with a distinct designated provider.
A service-view encompasses a set of <em>assets</em>.</p>
</li>
<li>
<p><strong>Assets:</strong> As <a href="#asset">previously defined</a>, an asset represents any physical or
virtual component of a cloud information system that has a value to an
organization and in particular the customer. A set of <em>attributes</em> is
attached to an asset.</p>
</li>
<li>
<p><strong>Attributes:</strong> As <a href="#attribute">previously defined</a>, an attribute describes a
characteristic of an asset that can be evaluated
quantitatively or qualitatively. CTP aims to address security
attributes, but the framework is generic enough to address any other
kind of attribute, including notably performance indicators.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Cloud service customers can query a CTP server to learn about
service-views that are exposed by the CSP. Next they can discover the
cloud service assets that comprise each service-view and finally, the
security attributes that are defined for each cloud service asset.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
CTP can also enable customers to learn about the list of cloud service
providers that compose a cloud supply chain, as described in <a href="#supply-chain">Accessing information about the supply chain</a>,
thereby facilitation compliance with data protection rules in some
jurisdictions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Associating a value with a security attribute requires the specification
of a <strong>measurement</strong>, which is a process that evaluates an attribute
concretely. By querying the CTP server, cloud service customers can
learn about the measurements that are available for each attribute.</p>
</div>
<div class="paragraph">
<p>Each measurement is associated with a <strong>measurement result</strong>, which
is the actual value or set of values representing the result of a
measurement (i.e. numbers, strings, booleans, etc.).</p>
</div>
<div class="paragraph">
<p>In addition a measurement may be also associated with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>An objective:</strong> A conditional expression that describes a constraint
on possible measurement results. When the constraint is violated, the
objective is considered as failed.</p>
</li>
<li>
<p><strong>Triggers:</strong> Like an objective, a trigger is also represented as a
conditional expression on the possible measurement results associated
with an attribute. When the conditional expression is true a message
is sent to the cloud service customer and the CTP server logs
an alert.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A measurement follows a certain number of concrete steps, collecting
events, making computations, and providing results in specific units,
which need to be interpreted accordingly. All these elements must be
defined and documented in a <strong>metric</strong> specification that is accessible to
the customer. Each measurement in CTP therefore references a metric,
which is split in two parts as described in <a href="#metrics">Metrics</a>.</p>
</div>
<div class="paragraph">
<p>To summarize some of the key elements above, an <em>attribute</em> defines
“what” we measure, a <em>measurement</em> (together with a <em>metric</em>) defines
“how” we measure, and a <em>measurement result</em> represents the result of
applying a <em>measurement</em> (how) to the <em>attribute</em> (what). An <em>objective</em>
describes the range of measured values that are considered to reflect an
agreed-upon level of security. A <em>trigger</em> describes the range of values
that will generate an alert to the customer.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. A fictitious cloud provider</div>
<div class="content">
<div class="paragraph">
<p>As an illustration, we can consider a fictitious example of a
cloud provider ”securebit.com”, which provides block storage containers
that are optionally encrypted with a symmetric algorithm to provide
confidentiality at the request of the customer. We could apply the CTP
data model as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The block storage container service is a service-view operated by
“securebit.com”.</p>
</li>
<li>
<p>Each block storage unit is a distinct asset (with a distinct
identifier).</p>
</li>
<li>
<p>Each block storage unit has one security attribute called
“confidentiality”.</p>
</li>
<li>
<p>We define “symmetric-key-length” as a measurement <span class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</span> of the attribute “confidentiality”, where
“symmetric-key-length” describes the process of evaluating the number of
bits in the symmetric key used to encrypt the data on the storage unit
(if no encryption is applied, “symmetric-key-length” is 0).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A customer might request all its storage blocks to be encrypted with
AES-CBC using a key of 192 bits or more. In this case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>objective</em> could be expressed as the following conditional
expression <span class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</span>:
“key_length&gt;=192”</p>
</li>
<li>
<p>Then the provider might establish and report that the <em>measurement
result</em> of the actual key-length is 256 bits (which means that the
objective is satisfied).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The elements briefly described so far provide a basic framework allowing
cloud customers to get information about the security level of a cloud
offering. However they are not sufficient to enable cloud customers to
compare or rank different offerings. In order to achieve this, cloud service
providers need to use CTP with a standardized set of asset categories,
attributes, measurement and metrics. These standardized elements must
be defined by relevant stakeholders and should derive from well-known
compliance frameworks (e.g. CSA CCM, ISO 27k, PCI-DSS, etc.) or form other
sector-specific requirements (see for example ongoing work in <a href="#ISO_19086">[ISO_19086]</a>).
In CTP, the adoption of these standards is signaled to the customer through the
use of <a href="#classes">service-classes or asset-classes</a>.</p>
</div>
<div class="paragraph">
<p>For the sake of simplicity, this brief introduction to the data model
leaves out many details as well as a few important concepts (i.e. <em>log
entries</em>). The following sections in this document describe the CTP
data model and the related RESTful API in full detail.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-ctp-data-model">4. The CTP Data Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the CTP data model, which is summarized in the
following UML diagram.</p>
</div>
<div id="uml-diagram" class="paragraph">
<div class="title">The CTP data model</div>
<p><span class="image"><img src="media/UML-diagram-3_2.png" alt="image"></span></p>
</div>
<div class="sect2">
<h3 id="json-representation">4.1. JSON representation</h3>
<div class="paragraph">
<p>With the exception of the <em>customer</em>, all elements in the data model
are translated into JSON resources that are made accessible by the CTP
server. The <em>customer</em> is not explicitly represented as a JSON object
in CTP but represents the fact that all resources in CTP are attached
directly or indirectly to a specific customer.</p>
</div>
<div class="paragraph">
<p>Before detailing each component of the CTP data model along with
their JSON encoding, it is necessary to introduce some conventions and
notations that are used throughout the section.</p>
</div>
<div class="sect3">
<h4 id="api-resources-urls">4.1.1. API Resources URLs and identifiers</h4>
<div class="paragraph">
<p>CTP exposes the following API resources to which HTTP methods can be
applied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The base URL (the CTP entry point advertised to the client).</p>
</li>
<li>
<p>Service-views.</p>
</li>
<li>
<p>Collection of service-views.</p>
</li>
<li>
<p>Collections of dependencies.</p>
</li>
<li>
<p>Log entries.</p>
</li>
<li>
<p>Collections of log entries.</p>
</li>
<li>
<p>Assets.</p>
</li>
<li>
<p>Collections of assets.</p>
</li>
<li>
<p>Security attributes.</p>
</li>
<li>
<p>Collections of security attributes</p>
</li>
<li>
<p>Measurements (which include Measurement results and Objectives).</p>
</li>
<li>
<p>Collections of measurements.</p>
</li>
<li>
<p>Triggers</p>
</li>
<li>
<p>Collection of triggers</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_resource_urls">4.1.2. Resource URLs</h4>
<div class="paragraph">
<p>Each CTP API resource is accessible through a URL composed of two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A base URL (the CTP API entry point)</p>
</li>
<li>
<p>A resource path (relative to the base URL)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the rest of this document the Base URL or CTP API entry point will be
referenced as <code>{CtpBase}</code>. While the <code>{CtpBase}</code> can be freely chosen by
the CTP server, the CTP API resource URL must follow the rules defined
in this specification.</p>
</div>
<div class="paragraph">
<p>A CTP API resource URL MUST be a fully qualified URL as defined in <a href="#RFC_3986">[RFC_3986]</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Decomposing a URL</div>
<div class="content">
<div class="paragraph">
<p>The following example shows the decomposition of a fully
qualified API resource URL:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:75%;"> 
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API resource URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://thecloud.com/serv/ctp/serviceUnit/02</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{CtpBase}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://thecloud.com/serv/ctp/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/serviceUnit/02</code></p></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="paragraph">
<p>Resource paths follow 4 possible structures:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>/t1</code> &#8594; this represents a collection of resources of type <code>t1</code>
(e.g. /serviceViews).</p>
</li>
<li>
<p><code>/t1/{id}</code> &#8594; this represents a single resource of type <code>t1</code>
identified by the unique resource identifier <code>{id}</code> (e.g. <code>/serviceViews/1234</code>).</p>
</li>
<li>
<p><code>/t1/{id}/t2</code> &#8594; this represents a collection of resources of
type <code>t2</code> that are scoped by a particular resource identified <code>/t1/{id}</code>
as previously described.</p>
</li>
<li>
<p>An empty resource path &#8594; By convention, accessing the empty resource
path (<code>/</code>) will provide <a href="#get-ctpbase">general information</a> about the CTP server and
protocol version.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Except for the CTP entry point <code>{CtpBase}</code>, resource paths SHALL NOT end
with a terminal <code>/</code> (i.e. <code>/serviceViews</code> is a correct path, while <code>/serviceViews/</code> is
incorrect and will typically result in a 404 http error).</p>
</div>
</div>
<div class="sect3">
<h4 id="identifiers">4.1.3. Identifiers</h4>
<div class="paragraph">
<p>In the remaining of this documentation, resource identifiers will be denoted
as <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>All identifiers SHALL be represented with the alphabet defined in the “Base64
Encoding with URL and Filename Safe Alphabet” described in section 5
of <a href="#RFC_4648">[RFC_4648]</a>, with a maximum of 96 characters per identifier. CTP
Server implementations MAY optionally further restrict identifiers to
smaller alphabets representing a subset of the one defined in this
specification, such as hexadecimal or decimal characters.</p>
</div>
</div>
<div class="sect3">
<h4 id="json-notations-used-in-the-specification">4.1.4. JSON notations used in the specification</h4>
<div class="paragraph">
<p>This specification uses the standard JSON types: <code>string</code>, <code>number</code>,
<code>object</code>, <code>array</code>, <code>boolean</code>, and <code>null</code>. To facilitate the
description of the API, it also uses specific pseudo-types, which are
simply restrictions on existing JSON types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>datetime</code>: a string that represent a UTC date and time as defined in
the <a href="#RFC_3339">[RFC_3339]</a>.</p>
</li>
<li>
<p><code>URL</code>: A string that represents a universal resource locator
(URL).</p>
</li>
<li>
<p><code>nested object</code>: A JSON object that appears within another JSON
object or array.</p>
</li>
<li>
<p><code>list</code>: A JSON array where all elements are of the same type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this specification when describing the content of a <em>list</em>, we will
describe the first element and add the symbol “&#8230;” to indicate that the
<em>list</em> is an array of 0 or more of those elements.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="icon-warning" title="Warning"></i>
</td>
<td class="content">
Unless otherwise specified, lists may contain 0 elements.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="common-properties-of-ctp-json-objects">4.1.5. Common properties of CTP JSON objects</h4>
<div class="paragraph">
<p>A few JSON properties recurrently appear in the description of CTP resources.
Firstly, all CTP JSON objects in CTP contain a property <code>self</code>.
Secondly, except for <em>collections</em> and <em>log entries</em>, all CTP JSON objects
contain the properties <code>name</code> and <code>annotation</code>. Finally, except for the
<em>CTP entry point</em>, all CTP JSON objects have a <code>scope</code> property.
These common properties are described more in detail hereafter.</p>
</div>
<div class="sect4">
<h5 id="self-property">The JSON "self" property</h5>
<div class="paragraph">
<p>All CTP API calls with the GET, PUT or POST method return a JSON
response, with a JSON object that contains the property <code>self</code>, which is a URL that
self-references the CTP resource being accessed. A GET query to this URL
refreshes the client&#8217;s representation of the CTP API resource. In a
response to a POST request, this URL represents the newly created CTP
API resource URL. If the GET request includes a query string, it shall
also be included in the self-reference provided in the response to the
request.</p>
</div>
<div class="paragraph">
<p>Self-references MUST only be provided in response bodies, never in
request bodies.</p>
</div>
</div>
<div class="sect4">
<h5 id="scope-property">The JSON "scope" property</h5>
<div class="paragraph">
<p>Except for the <em>CTP entry point</em>, all resources in CTP have a scope, as illustrated
in the data model and as further detailed in <a href="#resources">Resources</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <em>service-view</em> is scoped to the <em>CTP entry point</em> (i.e. <code>{CtpBase}</code>).</p>
</li>
<li>
<p>An <em>asset</em> is scoped to a specific <em>service-view</em>.</p>
</li>
<li>
<p>An <em>attribute</em> is scoped to a specific <em>asset</em>.</p>
</li>
<li>
<p>A <em>measurement</em> is scoped to a specific <em>attribute</em>.</p>
</li>
<li>
<p>A <em>log entry</em> or a <em>trigger</em> is scoped to a specific <em>service-view</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This scoping also applies to <em>collections</em> (e.g. a collection of <em>measurements</em> is scoped to a specific <em>attribute</em>).</p>
</div>
<div class="paragraph">
<p>The scope of a JSON object is described by the property <code>scope</code>, which
contains a CTP URL describing the scope of the current resource.</p>
</div>
<div class="paragraph">
<p>Scoping also allows the CTP server to implement access control: each customer
has only access to a specific set of <em>service-views</em>, which in turn gives them access
to a specific set of <em>assets</em>, <em>log entries</em> or <em>triggers</em>, and so and so forth.</p>
</div>
</div>
<div class="sect4">
<h5 id="name-property">the JSON "name" property</h5>
<div class="paragraph">
<p>Except for <em>collections</em> and <em>log entries</em>, all CTP JSON resources
contain a property <code>name</code>. This property is designed to hold an alternate identifier
for the resource that is meaningful to the customer or provider. This alternate identifier
can hold any valid string and is not bound by the format that is imposed on the CTP resource
identifiers that appear in resource URLs as defined in <a href="#identifiers">Identifiers</a>.
This alternate identifier can be used for example
to represent the unique identifier of a cloud resource (e.g. a virtual machine id), a
standardised name for an attribute or a metric, etc. The CTP server does not interpret
this value but it can be used as a search criteria in a query to a collection, as detailed in
<a href="#collections">Collections</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="annotation-property">the JSON "annotation" property</h5>
<div class="paragraph">
<p>Except for <em>collections</em> and <em>log entries</em>, all CTP JSON resources
contain a property <code>annotation</code>. This property is designed to hold human
readable text for information purpose only, the content of which is not
interpreted by CTP and may be left empty.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Self links, alternate identifiers and annotations</div>
<div class="content">
<div class="paragraph">
<p>The following truncated example shows a response to a CTP GET query
to the URL <code>https://example.com/ctp/serviceViews/123abc</code>, illustrating
the self links, alternate identifiers and annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": "https://example.com/ctp/serviceViews/123abc",
    "scope": "https://example.com/ctp/serviceViews/0001",
    "name": "disk:9708959262-9436488858-1118416481-4582989187",
    "annotation": "Cloud storage service",
    ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collections">4.1.6. Collections</h4>
<div class="paragraph">
<p>As described in <a href="#api-resources-urls">API Resources URLs and identifiers</a>, API queries to URLs of the form
<code>/t1</code> or <code>/t1/{id}/t2</code> target collections.</p>
</div>
<div class="paragraph">
<p>The JSON representation of a collection has the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "collectionLength": number,
    "returnedLength": number,
    "collectionType": string,
    "collection": [
        {
            "link": URL,
            "name": string
        },
        ...
    ]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:22%;">
<col style="width:11%;">
<col style="width:66%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Self-reference</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the scope of the collection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collectionLength</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The total number of elements in the collection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>returnedLength</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The total number of elements returned in the
collection in the response, which will be equal to collectionLength or
less, depending on the use of the query string parameters page and
items, as described below.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collectionType</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A string describing the type of resource listed in the collection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collection</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An ordered list representing links to items in the collections.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collection[].link</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A URL pointing to a CTP resource.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collection[].name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An <em>optional</em> string representing the name associated with the resource.
                                 This property is omited when the name associated to the resource is empty.</p>
</div></div></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>The property <code>collectionLength</code> describes the size of the collection, while
<code>returnedLength</code> describes the actual number of elements returned in the
response.</p>
</div>
<div class="paragraph">
<p>Links in the collection MUST be ordered. Collections of log entries MUST be ordered by
chronological order, by reference to their timestamp (see <a href="#log-entries">Log entries</a>).
For other types of collections, the choice of the
ordering function applicable to links in the collection is left to the
implementation. However, links returned in a collection MUST always be
ordered the same way across queries. This ordering MUST allow
internally for the implementation to index each link in increasing order
from 0 to <code>collectionLength</code>-1.</p>
</div>
<div class="paragraph">
<p>A plain <code>GET</code> query without a query string returns the whole collection.
In that case <code>collectionLength</code> will have the same value as
<code>returnedLength</code>, as shown in the example below.</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. A GET query to a collection.</div>
<div class="content">
<div class="paragraph">
<p>A GET query to the collection identified by the URL:</p>
</div>
<div class="paragraph">
<p><code>http://example.com/ctp/serviceViews/1/assets</code></p>
</div>
<div class="paragraph">
<p>provides the following result describing a collection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": "http://example.com/ctp/serviceViews/1/assets",
    "scope": "http://example.com/ctp/serviceViews/1",
    "collectionLength": 5,
    "returnedLength": 5,
    "collectionType": "assets",
    "collection": [
        {
            "link": "https://example.com/ctp/assets/1",
            "name": "asset 1"
        },
        {
            "link": "https://example.com/ctp/assets/2",
            "name": "asset 2"
        },
        {
            "link": "https://example.com/ctp/assets/3",
            "name": "asset 3"
        },
        {
            "link": "https://example.com/ctp/assets/4",
            "name": "asset 4"
        },
        {
            "link": "https://example.com/ctp/assets/5"
            "name": "asset 5"
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>CTP clients can however set a limit on the size of the returned
collection using the query string parameters <code>items</code> and <code>page</code>.
They may also restrict the result to resources that match a specific
<code>name</code> (see <a href="#name-property">the JSON "name" property</a>).</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Query parameter name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>Optional</em> page number, represented as an integer
                                     greater or equal to 0.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>items</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>Optional</em> number of elements returned in the
                                     collection, represented as an integer strictly greater than 0.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>Optional</em> string to restrict result to a specific
                                     alternate identifier. Only resource that match the value of <code>name</code>
                                     are returned.</p>
</div></div></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<div class="title">Limiting the returned results with <em>size</em> and <em>page</em></div>
<p>The query parameters <code>page</code> and <code>items</code> MUST either be both specified or
both omitted.</p>
</div>
<div class="paragraph">
<p>When these parameters are specified, a GET query to the collection MUST
only return the existing links in the collection with indices between
<code>page*items</code> and <code>page*items+items-1</code>, inclusive. In this case, the
<code>returnedLength</code> returned in the response will report the actual number of
links returned, which is always equal or less than the value of <code>items</code>.</p>
</div>
<div class="paragraph">
<p>The following 3 examples illustrate the use of different values for <code>page</code>
and <code>items</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Pagination of collection results - first page</div>
<div class="content">
<div class="paragraph">
<p>Given the collection presented in the example above, a GET query to</p>
</div>
<div class="paragraph">
<p><code>http://example.com/ctp/serviceViews/1/assets?page=0&amp;items=3</code></p>
</div>
<div class="paragraph">
<p>would return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": "http://example.com/ctp/serviceViews/1/assets?page=0&amp;items=3",
    "scope": "http://example.com/ctp/serviceViews/1",
    "collectionLength": 5,
    "returnedLength": 3,
    "collectionType": "assets",
    "collection": [
        {
            "link": "https://example.com/ctp/assets/1",
            "name": "asset 1"
        },
        {
            "link": "https://example.com/ctp/assets/2",
            "name": "asset 2"
        },
        {
            "link": "https://example.com/ctp/assets/3",
            "name": "asset 3"
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 6. Pagination of collection results - last page</div>
<div class="content">
<div class="paragraph">
<p>Next, a GET query to</p>
</div>
<div class="paragraph">
<p><code>http://example.com/ctp/serviceViews/1/assets?page=1&amp;items=3</code></p>
</div>
<div class="paragraph">
<p>would return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": "http://example.com/ctp/serviceViews/1/assets?page=1&amp;items=3",
    "scope": "http://example.com/ctp/serviceViews/1",
    "collectionLength": 5,
    "returnedLength": 2,
    "collectionType": "assets",
    "collection": [
        {
            "link": "https://example.com/ctp/assets/4",
            "name": "asset 4"
        },
        {
            "link": "https://example.com/ctp/assets/5"
            "name": "asset 5"
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 7. Pagination of collection results - beyond last page</div>
<div class="content">
<div class="paragraph">
<p>Finally, a GET query to</p>
</div>
<div class="paragraph">
<p><code>http://example.com/ctp/serviceViews/1/assets?page=2&amp;items=3</code></p>
</div>
<div class="paragraph">
<p>would return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": "http://example.com/ctp/serviceViews/1/assets?page=2&amp;items=3",
    "scope": "http://example.com/ctp/serviceViews/1",
    "collectionLength": 5,
    "returnedLength": 0,
    "collectionType": "assets",
    "collection": [
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the last example, the returned collection is empty because the
combination of the query string parameters <code>page</code> and <code>items</code> points
to indices beyond the end of the collection.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resources">4.2. Resources</h3>
<div class="sect3">
<h4 id="ctpbase">4.2.1. CTP entry point (CtpBase)</h4>
<div class="sect4">
<h5 id="_description">Description</h5>
<div class="paragraph">
<p>A query to the CTP base URL (denoted <code>{CtpBase}</code>) provides general information
about the CTP server to a CTP client (e.g. the CTP server version number).</p>
</div>
<div class="paragraph">
<p>The CTP entry point represents the &#8220;root&#8221; in the hierarchical scoping of all
CTP JSON resources accessible to a customer.</p>
</div>
<div class="paragraph">
<p>The <strong>CTP entry point</strong> is defined by the following elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <em>version</em>: the CTP API version number: "1.0" in this specification.</p>
</li>
<li>
<p>A <em>provider</em>: the identity of the provider of the CTP server.</p>
</li>
<li>
<p>A reference to a <em>collection of service-views</em>: this collection represents
the service-views that are accessible to the CTP client based on the
credentials it provides.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "name": string,
    "annotation": string,
    "version": string,
    "provider": string,
    "serviceViews": URL
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}</code> Contrary to all other CTP resources, this URL ends with a <em>/</em> character.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional alternate identifier for the resource as detailed <a href="#name-property">[name-property]</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of the CTP server
                         (may be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The version of CTP in use (i.e. the string "1.0")</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>provider</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the entity providing the CTP server.
                         This entity may be different from the one listed in <a href="#service-views">service-views</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>serviceViews</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link referencing the CTP URI where further information can be obtained
                           about the service-views that the client is authorized to access/query based on
                           its credentials.</p>
</div>
<div class="paragraph">
<p>The link is always equal to <code>{CtpBase}/serviceViews</code></p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="service-views">4.2.2. Service-views</h4>
<div class="sect4">
<h5 id="_definition">Definition</h5>
<div class="paragraph">
<p>A service-view represents a service offered to
a specific customer under the responsibility of a single provider. This service
is usually described in a SLA or service interface. A service-view encompasses
a set of assets.</p>
</div>
<div class="paragraph">
<p>In CTP a <strong>service-view</strong> is defined by 8 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the CTP entry point <code>{CtpBase}</code>.</p>
</li>
<li>
<p><em>A name</em>: A optional name for the service unit.</p>
</li>
<li>
<p><em>A provider</em>: The provider that has the contractual and legal
responsibility for providing the functionalities offered by the
service-view.</p>
</li>
<li>
<p><em>A collection of dependencies</em>: The list of supplementary service-views that
this service-view relies upon to operate. These dependent service-views
may either be operated by the same provider or by a third party. This
list may be empty.</p>
</li>
<li>
<p><em>A collection of assets</em>: The set of assets associated with the
service-view.</p>
</li>
<li>
<p>An optional <em>service class reference</em>: A reference to a
standardized set of security attributes and measurement contexts this
service unit strictly adheres to.</p>
</li>
<li>
<p><em>A collection of logs</em>: The logs that are accessible in this service-view.</p>
</li>
<li>
<p><em>A collection of triggers</em>: The triggers that are part of the service-view.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following constraints apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A service-view cannot reference itself in the dependency list.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A service-view associates groups of assets that are used together to
provide a service to a customer under the legal responsibility of a
specific cloud service provider.
In the simplest case, a service-view can be considered
as synonymous to “cloud service”. However, a “cloud service” can be
broken down into 2 or more “service-views” to highlight independent
components that share no common functionalities within a service (e.g. a IaaS
platform might be broken down into two distinct “compute” and “storage”
service-views). As such, the concept of service-views is meant to be
sufficiently abstract to provide the flexibility to address a variety of
use-cases and is meant to apply to any layer of the cloud stack from
IaaS to SaaS.</p>
</div>
<div class="paragraph">
<p>By enforcing the association between a particular customer and a
particular service-view (or set of service-views), the CTP server
can implement an effective access control mechanism, since all
other resources are scoped directly or indirectly to a service-view.</p>
</div>
<div class="paragraph">
<p>The optional reference to a service class is used to impose restrictions
on the security attributes associated with all the assets of a
service-view, for the purpose of interoperability. By default, when no
service class is referenced, the assets of a service-view can be
associated with an arbitrary set of security attributes, using any
measurement. However, when a service-view specifically references a
<em>service class</em>, the list of usable attributes and their measurement
contexts must strictly follow the specifications of the referenced
<em>service class</em>. Cloud providers SHOULD adopt service-classes or
asset-classes for the benefit of customers (see <a href="#classes">Service classes and asset classes</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="service-views-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "name": string,
    "annotation": string,
    "provider": string,
    "dependencies": URL,
    "assets": URL,
    "serviceClass": URL
    "logs": URL,
    "triggers": URL
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/serviceViews/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the <a href="#ctpbase">CTP entry point</a> that exposes this service-view, which is a URL of the form <code>{CtpBase}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional alternate identifier for the resource as detailed <a href="#name-property">[name-property]</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>a human readable description of this service-view
(may be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>provider</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the provider that is legally
responsible for providing the service-view. This provider might be
different from <a href="#get-ctpbase">[get-ctpbase]</a> the one offering the CTP service itself&gt;&gt;.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dependencies</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link providing a location where information can
be found regarding the dependencies of this service-view. This link is
of the form <code>{CtpBase}/serviceViews/{id}/dependencies</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assets</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link providing a location where information can be
found regarding all the resources of this service-view. This link is of
the form <code>{CtpBase}/serviceViews/{id}/assets</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>serviceClass</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The service class applicable to all assets
and attributes of this service-view. Must be set to an empty string if no service
class applies.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logs</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link providing a location where information can be found regarding all
the logs that are stored by the CTP server for this service-view, as the results
of triggers.</p>
</div>
<div class="paragraph">
<p>This link is of the form <code>{CtpBase}/serviceViews/{id}/logs</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>triggers</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link providing a location where information can be found regarding all
the triggers that have been defined in the CTP server for this service-view.</p>
</div>
<div class="paragraph">
<p>This link is of the form <code>{CtpBase}/serviceViews/{id}/triggers</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="assets">4.2.3. Assets</h4>
<div class="sect4">
<h5 id="_definition_2">Definition</h5>
<div class="paragraph">
<p>An <a href="#asset">asset</a> is used to represent any tangible or intangible element
of a cloud information system, such as for example simple API URLs,
storage, processor cores or compute instances, databases, full blown
platforms, etc. A set of attributes is attached to an asset.</p>
</div>
<div class="paragraph">
<p>In CTP, an <strong>asset</strong> is defined by 4 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the service-view this resource belongs to.</p>
</li>
<li>
<p><em>A name</em>: A unique name describing the resource in a way that is
unambiguous for the customer in the context of the service offered (e.g.
“API.GetBlock()”, “storage-0458-fb04”, “http://example.com/login”.)</p>
</li>
<li>
<p><em>A collection of applicable attributes</em>: The set of (security) attributes
for which measurements can be produced for this particular asset.</p>
</li>
<li>
<p>An optional <em>asset class reference</em>: A reference to a standardized
set of security attributes and measurement contexts this asset strictly
adheres to.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Service resources are the virtual or physical elements to which a set of
security attributes apply.</p>
</div>
<div class="paragraph">
<p>Following the same principle as “service classes” in service-views, the
optional reference to an asset class is used to impose restrictions on
the security attributes associated with an asset of a service-view, for
the purpose of interoperability. By default, when (1) no asset class is
referenced and (2) when no service class is referenced at service-view
level, the assets of a service-view can be associated with an arbitrary
set of security attributes, using any measurement. However, when an
asset specifically references an asset <em>class</em>, the list of usable
attributes and their measurement contexts must strictly follow the
specifications of the referenced <em>asset class</em>. Cloud providers SHOULD
adopt service-classes or asset-classes for the benefit of customers (see
<a href="#classes">Service classes and asset classes</a>).</p>
</div>
<div class="paragraph">
<p>For simplicity and flexibility, CTP does not impose any constraints on
the definition of what constitutes an asset. In some cases an asset
might describe a software service and in some other cases an instance
produced by such a service. For example, both an IaaS API that creates
virtual machines and the produced virtual machines could be considered
as “assets” with security attributes, depending on the context and the
needs of the provider and his customers. To avoid ambiguities, it is
therefore important to name assets unambiguously and to convey their
scope clearly to cloud service customers.</p>
</div>
</div>
<div class="sect4">
<h5 id="assets-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "name": string,
    "annotation": string,
    "attributes": URL,
    "assetClass": URL
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/assets/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the service-view this asset belongs to.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the cloud resource (e.g. "Storage", "get_block()", "http://example.com/service/").</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of this service resource (may be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>attributes</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the collection of security attributes
defined for this service resource.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assetClass</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The service class applicable to the security
attributes of this asset. Must be set to the empty string if undefined.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="attributes">4.2.4. Attributes</h4>
<div class="sect4">
<h5 id="_definition_3">Definition</h5>
<div class="paragraph">
<p>A security attribute or more simply an <a href="#attribute">attribute</a> is used to
represent characteristic of an asset that can be evaluated
quantitatively or qualitatively and is identified with a distinct name
(e.g. “availability”, “incident response”, etc.). Associating a value
with a security attribute requires the specification of a measurement.</p>
</div>
<div class="paragraph">
<p>In CTP an <strong>attribute</strong> <span class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnote_4" title="View footnote.">4</a>]</span> is defined by 3 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the asset to which this attribute applies.</p>
</li>
<li>
<p><em>A name</em>: A generic name of the attribute.</p>
</li>
<li>
<p><em>A collection of available measurements</em>: The list of possible measurements
that can be used to evaluate this attribute.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following constraints apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each attribute is associated with only one asset (scope).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, an attribute will have only one measurement: there will
be only one defined process to quantify the attribute. However, for some
attributes, it makes sense to have several measurements (e.g. to
distinguish the monthly evaluation of availability form the hourly
evaluation of availability).</p>
</div>
</div>
<div class="sect4">
<h5 id="attributes-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "name": string,
    "annotation": string,
    "measurements": URL
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/attributes/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the asset this attribute applies to.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of this security attribute (may be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The optional name of the security attribute (see <a href="#name-property">[name-property]</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurements</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link of the form <code>{CtpBase}/attributes/{id}/measurements</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="metrics">4.2.5. Metrics</h4>
<div class="sect4">
<h5 id="_definition_4">Definition</h5>
<div class="paragraph">
<p>A <a href="#metric">metric</a> describes a standard of measurement, which will be
referenced in <a href="#measurement">measurements</a>. A metric is typically specified
in an external document that describes in human readable form <em>the
conditions and the rules for performing the measurement and for
understanding the results of a measurement.</em> This external document is
called a “reference metric” in CTP and needs to be completed with
concrete machine-readable information to be useful in CTP. In
particular, while the reference metric MAY describe possible measurement
parameters, their <a href="#measurement-parameter-value">values</a> MUST be determined for the metric to be
applied concretely.</p>
</div>
<div class="paragraph">
<p>In CTP a <strong>metric</strong> is defined by 4 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A name</em>: the name of the metric, which highlights its purpose and
distinguishes it from other metrics.</p>
</li>
<li>
<p><em>A link to a reference metric</em>: an external document that
describes in human readable form the metric (i.e. <em>the conditions and
the rules for performing the measurement and for understanding the
results of a measurement</em>).</p>
</li>
<li>
<p><em>A list of measurement parameter values</em>: a list of parameters
that are used to quantify the value of a security attribute. This list
may be empty if no parameter is needed in the measurement. Each parameter
in the list is composed of three elements:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A measurement parameter name.</p>
</li>
<li>
<p>A measurement parameter type.</p>
</li>
<li>
<p>A measurement parameter value.</p>
</li>
</ol>
</div>
</li>
<li>
<p><em>A measurement result format</em>: A description of the type and
format of the result of the measurement that is conducted according to
the reference metric and the measurement parameter values.
Measurement results are represented as a <a href="#relating-measurement-results-and-metrics">table of values</a>
and the measurement result format included in the metric is simply a
description of the columns of that table, as a list where each item is
composed of:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A column name.</p>
</li>
<li>
<p>A column type.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following constraints apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two metrics SHOULD share the same name if and only if they use
the same reference metric, the same measurement parameters and the same
measurement result format.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We highlight that the “reference metric” is not explicitly defined as an
object in the CTP data model: it is only defined as an external link
(using a URL). This allows to reference metrics from external public
standards or other documents made available by cloud providers.</p>
</div>
<div class="paragraph">
<p>The list of <a href="#measurement-parameter-value">measurement parameter values</a> is used to further
specify or restrict how the measurement of a security attribute is
conducted, as described in the reference metric. For example, when
measuring availability of a service, we may wish to define the maximum
delay allowed for a service request to be executed by the service
provider before the request can be considered as failed. The reference
metric will describe this parameter and give it a name but may not
necessarily give it a prescriptive value. However, in order to apply a
metric in a concrete case, this value must be specified: this is the
role of the measurement parameter values in the metric. Other
measurement parameters that could be used for a metric related to
availability include: the measurement period (e.g. a week, a month),
specific constraints (e.g. business hour specific thresholds), and
sample sizes, etc. Some of these measurement parameter values may be
already defined in the externally referenced reference metric but should
be repeated in the measurement for information purposes.</p>
</div>
</div>
<div class="sect4">
<h5 id="metrics-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "name": string,
    "annotation": string,
    "baseMetric": URL,
    "measurementParameters": [
        {
            "name": string,
            "type": string,
            "value": string or number or boolean,
        },
        ...
    ],
    "resultFormat": [
        {
            "name": string,
            "type": string,
        },
        ...
    ]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Self-reference <code>{CtpBase}/metrics</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A standardized name for the metric, as specified in the
document provided in referenceMetric (see <a href="#name-property">[name-property]</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of this metric (may
be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>baseMetric</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>External link to the metric implemented by this
measurement. This is a human readable document standardizing the metric.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurementParameters</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of measurement parameters</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurementParameters[].name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the measurement
parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurementParameters[].type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The type of the measurement
parameter, which is either “boolean”, “number” or “string”.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurementParameters[].value</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em> or <em>number</em> or <em>boolean</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The
value of the measurement parameter, encoded either as a string, number
or boolean (depending on the type).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resultFormat</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This element provides a description of the format
of the result of the measurement. Measurement results are represented as
tables and this element provides the list of names of the columns that
compose that table as well as their type.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resultFormat[].name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The name of the table column (e.g.
"percentage").</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resultFormat[].type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A description of the type of the items
in the column, which is either “boolean”, “number” or “string”.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="measurements">4.2.6. Measurements</h4>
<div class="sect4">
<h5 id="_definition_5">Definition</h5>
<div class="paragraph">
<p>A <a href="#measurement">measurement</a> describes how a specific attribute is evaluated,
using a specific <a href="#metric">metric</a>.</p>
</div>
<div class="paragraph">
<p>In CTP a <strong>measurement</strong> is defined by 9 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the attribute to which this measurement
applies.</p>
</li>
<li>
<p><em>A name</em>: The optional name of this measurement (see <a href="#name-property">the JSON "name" property</a>).</p>
</li>
<li>
<p><em>A reference to a metric</em>: A reference to the metric that is
implemented by this measurement in order to quantify or qualify an
attribute.</p>
</li>
<li>
<p><em>A measurement result</em>: see <a href="#results">below</a>. This element may be null if a
result is not available.</p>
</li>
<li>
<p><em>A measurement result signature</em>: see <a href="#results">below</a>. This optional element
represents a JSON Web Signature on the measurement result, following
<a href="#RFC_7515">[RFC_7515]</a>.</p>
</li>
<li>
<p><em>An objective</em>:  See <a href="#objectives">below</a>. This element may be null if no
objective is defined.</p>
</li>
<li>
<p><em>A trigger creation indicator</em>: An element that indicates whether or
not the CTP client is allowed to create triggers for this measurement.</p>
</li>
<li>
<p><em>A user-activation indicator</em>: An element that indicates whether or
not the CTP client is responsible for activating the measurement.</p>
</li>
<li>
<p><em>A state</em>: An indicator describing the current monitoring state of the
security attribute through this measurement, which can hold one of the
following 3 values:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>“activated”: This specific measurement is activated and the security
attribute is monitored accordingly. The attribute can be queried for
measurement results and/or activate triggers, depending on the
capabilities of the measurement.</p>
</li>
<li>
<p>“deactivated”: This specific measurement is not activated but the
cloud provider has the capability to do so. The cloud service customer
must first activate this measurement with the CTP API before the cloud
provider is able to provide measurement results and/or triggers about
the related attribute.</p>
</li>
<li>
<p>“pending”: This transitional state indicates that the cloud provider
has not enough data yet to provide measurement results and/or activate
triggers about the attribute, with this specific measurement. This is
notably intended for cases where a measurement has been activated by the
cloud service customer but is not “ready” to be queried yet for
measurement results due to lack of sufficient monitoring data for
example.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By design, a cloud service provider implementing CTP has full control
over the use of <em>measurement</em>, and can apply the following
restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The CTP server can set an objective for a measurement or not.</p>
</li>
<li>
<p>The CTP server can allow triggers for a measurement or not.</p>
</li>
<li>
<p>The CTP server can provide CTP clients with the capacity to activate a
measurement or not.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, if the asset to which the measured attribute is attached
adheres to an asset-class or if the service-view adheres to a
service-class, the cloud service provider SHALL implement the
capabilities defined in the external <em>asset class</em> or <em>service class</em>
specification (see <a href="#classes">Service classes and asset classes</a>).</p>
</div>
<div class="paragraph">
<p>In some cases, a cloud provider may not wish to conduct the measurement
of a security attribute of an asset on a continuous basis, but will only
initiate a measurement at the request of a cloud service customer. In
CTP these measurements are distinguished from others through an
“user-activation” indicator that is set to “true”. Measurements that are
“user-activated” are by default in “deactivated” state, which means that
the related attribute is not evaluated with the specified metric. Cloud
service customers can use the CTP API to activate these measurements (see <a href="#put-measurements-id-state">PUT {CtpBase}/measurements/{id}?x=state`</a>).
Optionally, the measurement can then be in “pending” state before
reaching “activated” state, while enough data is gathered by the
monitoring infrastructure for example. Once in “activated” state, these
measurements can produce measurement results and activate triggers.
These “user-activated” measurements are used in situations where the
intervention of the cloud service customer is meaningful. This would be
for example the case for a measurement that requires a vulnerability
scan, which could be requested by the cloud service customer
occasionally instead of being constantly conducted the provider.</p>
</div>
<div class="paragraph">
<p>The measurement results and objectives are detailed in the following
subsections.</p>
</div>
<div id="results" class="paragraph">
<div class="title">Measurement results</div>
<p>A measurement result appears as part of measurements and log entries.</p>
</div>
<div class="paragraph">
<p>A measurement result reflects the state of a resource at a specific time.</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. A measurement result</div>
<div class="content">
<div class="paragraph">
<p>Consider the following example of a measurement result: &#8220;For our storage
service, the percentage of uptime was 99.92% on December 31st, 2012, for
a period of one month.&#8221;</p>
</div>
</div>
</div>
<div class="paragraph">
<p>A <strong>measurement result</strong> is defined by 3 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <em>value</em>: The actual representation of the measurement result in
a table format. The number of columns and rows of that table depends on
the referenced measurement. In particular, the number of columns in the
table corresponds to the number of columns defined in the <em>measurement
result format</em> of the underlying <em>metric</em>.</p>
</li>
<li>
<p>A <em>timestamp</em>: The date and time the measurement result was
produced.</p>
</li>
<li>
<p><em>An authority-identifier</em>: An optional identifier of the entity
producing the measurement result. This element is optional and is mainly
intended to be used when a signature is added.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the general case, the entity producing the measurement result will be
the cloud provider, but other alternatives could be envisaged including
trusted third parties or TPM modules. In these alternative cases the
entity SHOULD be identified in the measurement result.</p>
</div>
<div class="paragraph">
<p>Additionally, the authority may cryptographically sign the content of
the measurement result, for authentication and integrity purposes. The
signature applies to the full content of the measurement result, using
the JSON Web Signature (JWS) as defined in <a href="#RFC_7515">[RFC_7515]</a>. The string
representing the signature in JWS Compact Serialization format is
provided in another property of the measurement. Providing a signature
is left to the choice of the cloud service provider, unless otherwise
dictated by an existing <a href="#classes">service-class or asset-class</a>.</p>
</div>
<div id="objectives" class="paragraph">
<div class="title">Objectives</div>
<p>An objective is an optional part of a measurement.</p>
</div>
<div class="paragraph">
<p>An <a href="#objective">objective</a> describes an expected result with
regards to a security attribute. This expected results is expressed as a
constraint on the measurement results of a security <a href="#attribute">attribute</a>.
It describes the security level that the cloud provider is
committed to achieve, as usually described to cloud service customers in
a service interface and/or SLA.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. An objective</div>
<div class="content">
<div class="paragraph">
<p>For example, as an objective, a cloud provider might
commit to restrict the <em>location of data processing</em> in a resource to
the set of 3 countries composed of Australia, Belgium and Canada.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>An <strong>objective</strong> is defined by 2 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A condition</em>: A representation of an objective as a boolean
expression describing a constraint on the expected result of the
measurement of the underlying security attribute.</p>
</li>
<li>
<p><em>A status</em>: A value describing the result of the evaluation of the
condition, which can take one of the following 3 values:</p>
<div class="ulist">
<ul>
<li>
<p>true: if the condition evaluates to true.</p>
</li>
<li>
<p>false: if the condition evaluates to false.</p>
</li>
<li>
<p>error: if an error occurs in the evaluation of the condition.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>In CTP, <em>conditions</em> in objectives are specified using conditional
expressions that are described in a small language called
<a href="#ctpscript">CTPScript</a> that is similar to JavaScript Expressions. The result
of a measurement is expressed as an array variable that can be used in a
CTPScript expression to describe a condition. If this CTPScript
expression does not evaluate correctly due to an error, then the status
of the objective is set to ‘error’. If the CTPScript expression
evaluates correctly to the boolean ‘true’, then the objective is
verified to be true, otherwise it is false.</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. An objective in CTPScript</div>
<div class="content">
<div class="paragraph">
<p>The following CTPScript expression might describe an
objective related to cryptographic key length used in
a SSL/TLS end-point:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>value[0].tls_symmetric_key_length &gt;= 128</pre>
</div>
</div>
<div class="paragraph">
<p>Some objectives can take a more complex form. Consider a measurement that
describes distinguishes availability between &#8220;business hours&#8221; and &#8220;other hours&#8221;
The following CTPScript expression might describe another
objective related to availability:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>value[0].business_hours_uptime &gt; 99.5 &amp;&amp; value[0].other_hours_uptime &gt; 98.0</pre>
</div>
</div>
<div class="paragraph">
<p>Note that in this example, the actual definition of what constitutes &#8220;business hours&#8221;
would likely be part of the measurement parameters of the <a href="#metrics">metric</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="measurements-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "name": string,
    "annotation": string,
    "metric": URL,
    "result": {
        "value": [
            nested object, ...
        ],
        "dateTime": datetime,
        "authorityId": string,
        "signature": string,
    },
    "objective": {
        "condition": string,
        "status": string,           // either "true", "false" or "error"
        "statusUpdateTime": datetime
    },
    "trigger": string,
    "userInitiated": boolean,
    "state": string             // either "deactivated", "pending" or "activated"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to
<code>{CtpBase}/measurements/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the attribute this measurement applies to.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of this measurement
(may be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metric</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A link to the metric implemented by this measurement.</p>
</div>
<div class="paragraph">
<p>This link is of the form: <code>{CtpBase}/metrics/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>nested object</em> or <em>null</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>If the measurement state is “pending” or “deactivated”, this object is
null (see the state property below).</p>
</div>
<div class="paragraph">
<p>Otherwise this object represents the current measurement result value,
following the format described in the linked <a href="#relating-measurement-results-and-metrics">metric</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.value</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>List</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of nested objects, each representing a row
in the table representing the measurement result, <a href="#relating-measurement-results-and-metrics">as defined in the metric</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.value[]</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>nested object</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A set of (key, value) pairs describing
a single row in the table representing the measurement result.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.updateTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A UTC timestamp of the measurement result as
defined in <a href="#RFC_3339">[RFC_3339]</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.authorityId</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A string representing the
identity of the entity that produced the measurement result. This
property MAY be null if the entity is the same as the service provider
or if it is not known. This property MUST be non-empty if the property
resultSignature is non-empty.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.signature</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string or null</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A string representing the JWS Compact Serialization of a JSON Web
Signature of a serialization of the object representing the content of
the result property, as defined in <a href="#RFC_7515">[RFC_7515]</a>.</p>
</div>
<div class="paragraph">
<p>This field MAY be an empty string if no signature is provided.</p>
</div>
<div class="paragraph">
<p>Implementations MUST support signatures provided with the algorithm
“RSASSA-PKCS1-v1_5 SHA-256”. Implementations MAY support other signature
standards.</p>
</div>
<div class="paragraph">
<p>The serialization of the result object is performed as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let P represent the JSON encoding of the result object, excluding the
signature property, but including all other previous fields, without any
change in encoding.</p>
</li>
<li>
<p>Remove all non-significant white space characters around the JSON
tokens of P: tabulation (U+0009), line feed (U+000A), carriage return
(U+000D), and space (U+0020)</p>
</li>
<li>
<p>Return the resulting string P, which must start with a left curly
bracket (U+007B) and end right curly bracket (U+007D)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The string P then represents the value of the payload used in the JSON
Web Signature.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>objective</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>nested object</em> or <em>null</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>If this property is not
<em>null</em>, then an objective has been defined for the measurement result,
as specified in the following 2 properties of the objective object.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>objective.condition</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A <a href="#ctpscript">CTPScript expression</a>. This
JSON string must be properly escaped</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>objective.status</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>boolean</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The result of the evaluation of the
CTPScript condition based on the current measurement result.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>createTrigger</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This optional link indicates where triggers for this measurement can be
created with a POST request or listed with a GET request.</p>
</div>
<div class="paragraph">
<p>The link is of the form <code>{CtpBase}/serviceViews/{id}/triggers</code>.</p>
</div>
<div class="paragraph">
<p>If the link is an empty string, this indicates that the measurement cannot be used
in a trigger.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userInitiated</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>boolean</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>If this field is true, then the CTP client can request to initiate the
measurement through a <a href="#put-measurements-id-state">specific API call</a>. This will cause
the state described hereafter to change accordingly.</p>
</div>
<div class="paragraph">
<p>If this field is false, this indicates that the client cannot initiate
the measurement.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>state</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This element represents the state of the attribute and can take 3 values
only: "activated" if the value of this security attribute is measurable,
"pending" if the value of this security attribute is not yet measurable,
due to missing or incomplete data, and "deactivated" if the field
requires to be user-activated.</p>
</div>
<div class="paragraph">
<p>A measurement that is user-activated is initially in a “deactivated”
state but can be activated with <a href="#put-measurements-id-state">a specific API call</a>.</p>
</div>
<div class="paragraph">
<p>A measurement that is not user-activated must always be in the
"activated" or "pending" state.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="triggers">4.2.7. Triggers</h4>
<div class="sect4">
<h5 id="_definition_6">Definition</h5>
<div class="paragraph">
<p>In order to enable cloud service customers to receive notifications when
specific conditions are met, CTP allows them to defines triggers. Like
an objective, a trigger is a conditional expression on the measured
value of a security attribute. However, contrary to objectives, triggers
are created by the CTP client with a specific API call. When a trigger
conditional expression is true, a message is sent to the cloud service
customer via XMPP <a href="#RFC_6120">[RFC_6120]</a> and an alert is logged by the cloud
provider. For example, a cloud client might request to be notified if
the <em>recovery time actual</em> (RTA) of a resource exceeds a certain
duration threshold.</p>
</div>
<div class="paragraph">
<p>A <strong>trigger</strong> is defined by 9 elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the service-view in which this trigger is defined.</p>
</li>
<li>
<p><em>A name</em>: An optional name for this trigger.</p>
</li>
<li>
<p><em>A reference measurement</em>: The measurement to which the trigger
applies.</p>
</li>
<li>
<p><em>A trigger condition</em>: A representation of a trigger as a
conditional expression that applies to the results of the measurement of
the underlying security attribute. When the condition is evaluated,
<a href="#evaluating-triggers">alerting rules</a> defined in this document are
applied to decide whether an alert is generated or not.</p>
</li>
<li>
<p><em>A XMPP notification URI</em>: This optional URI describes an XMPP
endpoint that will receive a notification in case of an alert. Note that
future versions of the CTP API may define other notification mechanisms
than XMPP, which will be distinguished by a different URI format.</p>
</li>
<li>
<p>A <em>guard time</em>: The minimal time, expressed in seconds, that should
elapse between two alerts generated from the same trigger. This is
indented to avoid alert overflows. This delay does not apply to alerts
that result from an error in the evaluation of the condition: such
alerts are only generated once regardless of how long the error
persists.</p>
</li>
<li>
<p>A <em>set of tags</em>: a set of keywords that will be added in the log entries produced
as a result of this trigger. Tags can also be later used to sort log
entries (a tag can be used for example to specify a severity level).</p>
</li>
<li>
<p>A <em>status</em>: a value that indicates the result of the last evaluation of the
trigger condition, which can take one of the following 3 values:</p>
<div class="ulist">
<ul>
<li>
<p>true: if the condition evaluates to true.</p>
</li>
<li>
<p>false: if the condition evaluates to false.</p>
</li>
<li>
<p>error: if an error occurs in the evaluation of the condition.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A <em>status timestamp</em>: a timestamp representing the point in time when the trigger
was last evaluated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In CTP, <em>conditions</em> in triggers are specified using conditional
expressions that are described in a small language called <a href="#ctpscript">CTPScript</a>
that is similar to JavaScript expressions. The result of
a measurement is expressed as an array variable that can be used in a
CTPScript expression to describe a condition. If this CTPScript
expression evaluates to the boolean ‘true’, then the <a href="#evaluating-triggers">alerting rules</a> defined in
this docuement are applied to decide whether an alert is generated or not (taking
the guard time into consideration), followed by a XMPP notification sent
to the cloud service customer.</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. A trigger condition in CTPScript</div>
<div class="content">
<div class="paragraph">
<p>The following CTPScript expression shows an example of a
trigger condition related to the redundancy level of a system
component:</p>
</div>
<div class="paragraph">
<p><code>value[0].redundancy &lt;= 2</code></p>
</div>
</div>
</div>
<div class="paragraph">
<p>In addition, if the CTP condition fails to evaluate correctly, due to an
error in the expression, then the <a href="#evaluating-triggers">alerting rules</a> defined in this docuement are also
applied to decide whether an alert is generated or not, followed by a
XMPP notification sent to the cloud service customer.</p>
</div>
<div class="paragraph">
<p>There are therefore two types of alerts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Normal alerts: alerts that are generated when the trigger condition
evaluates to ‘true’ in CTPScript.</p>
</li>
<li>
<p>Error alerts: alerts that are generated when an error occurs in the
evaluation of the CTPScript condition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each one of these types of alerts corresponds to a <a href="#log-entries">different type of
log</a>. The XMPP notification that is sent as a
result of an alert MUST contain a copy of the log entry that is created
as a result of the trigger. Similarely, in case of an error, an XMPP message
containing the log entry describing the error MUST be sent.</p>
</div>
<div class="paragraph">
<p>Providers implementing the CTP API MAY use their own out-of-band
mechanism to validate the XMPP endpoint provided by the cloud service
customer if needed. Such a validation mechanism is out of scope of this
document.</p>
</div>
</div>
<div class="sect4">
<h5 id="triggers-encoding">Encoding</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "scope": URL,
    "name": string,
    "annotation": string,
    "measurement": URL,
    "condition": string,
    "notification": URL,
    "guardTime": number,
    "tags": [
        string, ...
    ],
    "status": string,           // either "true", "false" or "error"
    "statusUpdateTime": datetime
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/triggers/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the <a href="#service-views">service-view</a> that exposes this trigger,
which is a URL of the form <code>{CtpBase}/serviceViews/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional name for this trigger (see <a href="#name-property">[name-property]</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A human readable description of the trigger (may
be empty).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>measurement</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the <a href="#measurements">measurement</a> to which this
trigger applies.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condition</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A <a href="#ctpscript">CTPScript expression</a>. This JSON string
must be properly escaped.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>notification</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Description of the XMPP URI that will be used to notify the cloud
service customer, following the structure defined in RFC 5122.</p>
</div>
<div class="paragraph">
<p>Implementation must recognize XMPP URI of the form</p>
</div>
<div class="literalblock">
<div class="content">
<pre>xmpp:&lt;node&gt;@&lt;server&gt;&lt;path&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;node&gt;</code> represent an
XMPP node name, <code>&lt;server&gt;</code> an XMPP server name and <code>&lt;path&gt;</code> a
possibly empty XMPP path descriptor.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>guardTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The amount of time in seconds that must elapse between 2 consecutive
alerts resulting from this specific trigger.</p>
</div>
<div class="paragraph">
<p>This is to avoid potential notification and log overflow in case where a
condition remains true for a long time, despite updated measurement
results.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of string tags.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags[]</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A keyword that will be recorded in the log entry
generated as a result of the trigger. This tag can later be used to sort
log entries.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>status</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The result of the last evaluation of the trigger. This
string can be either "true", "false" or "error".</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>statusUpdateTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A UTC timestamp (as defined in <a href="#RFC_3339">[RFC_3339]</a>
representing the point in time when the trigger condition was last evaluated.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="log-entries">4.2.8. Log entries</h4>
<div class="sect4">
<h5 id="_definition_7">Definition</h5>
<div class="paragraph">
<p>Log entries are generated by triggers and can have two different forms:</p>
</div>
<div class="paragraph">
<p>Form 1, Normal log entry:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the service-view to which this log entry belongs.</p>
</li>
<li>
<p><em>A trigger reference</em>: A reference to the trigger that generated
this log entry.</p>
</li>
<li>
<p><em>A timestamp</em>: The date and time of the alert.</p>
</li>
<li>
<p><em>A measurement result</em>: A measurement result corresponding to the
value that verified the trigger condition (see the <a href="#measurements-encoding">encoding of measurements</a>).</p>
</li>
<li>
<p><em>A set of tags</em>: A set of tags that is associated with the entry,
as specified in the referenced trigger.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Form 2, Error log entry:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>A scope</em>: A reference to the service-view to which this log entry belongs.</p>
</li>
<li>
<p><em>A trigger reference</em>: A reference to the trigger that generated
this log entry.</p>
</li>
<li>
<p><em>A timestamp</em>: The date and time of the error.</p>
</li>
<li>
<p><em>An error message</em>: A message describing an error in the
evaluation of a trigger condition.</p>
</li>
<li>
<p><em>A set of tags</em>: A set of tags that contains only one item, the
tag “error”.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="normal-log-entries-encoding">Encoding of normal log entries</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "trigger": URL,
    "creationTime": datetime,
    "result": {
        "value": [
            nested object, ...
        ],
        "updateTime": datetime,
        "authorityId": string,
        "signature": string
    }
    "tags": [
        string, ...
    ]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/logs/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trigger</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the trigger that generated this
log entry, which is of the form <code>{CtpBase}/triggers/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>creationTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A timestamp for the creation of the log entry.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>nested object</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The measurement result that made the trigger
condition true. This element is defined exactly as the <code>result</code> property
in a <a href="#measurements-encoding">encoded measurement</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.value</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>See the <a href="#measurements-encoding">encoding of measurements</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.updateTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>See the <a href="#measurements-encoding">encoding of measurements</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.authorityId</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>See the <a href="#measurements-encoding">encoding of measurements</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result.signature</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>See the <a href="#measurements-encoding">encoding of measurements</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of tags associated with the trigger. May be an
empty list if no tag is set.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags[]</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A tag that was associated with the trigger.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
<div class="sect4">
<h5 id="error-log-entries-encoding">Encoding of error log entries</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "trigger": URL,
    "creationTime": datetime,
    "error": string,
    "tags": [
        "error"
    ]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> to <code>{CtpBase}/logs/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trigger</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A reference to the trigger that generated this
log entry, which is of the form <code>{CtpBase}/triggers/{id}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>creationTime</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A timestamp for the creation of the log entry.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A description of the error in the CTPScript evaluated
in the trigger.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of tags associated with the trigger. In the case
of an error, this list contains one element.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags[]</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The string “error”.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="sect2">
<h3 id="classes">4.3. Service classes and asset classes</h3>
<div class="paragraph">
<p>Where feasible, cloud service providers SHOULD adopt service classes or
asset classes, as defined in this section.</p>
</div>
<div class="paragraph">
<p>From a purely modeling perspective, CTP leaves a lot of flexibility to
cloud service providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assets can be associated with an arbitrary sets of security
attributes;</p>
</li>
<li>
<p>Security attributes can be quantified with different measurements,
using different metrics with different measurement parameter values;</p>
</li>
<li>
<p>The provider can choose whether measurements can have objectives,
triggers, or can be user-activated.</p>
</li>
<li>
<p>The provider can choose whether measurement results are
cryptographically signed or not.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In real use-cases, this flexibility can have some significant drawbacks
for customers because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it can make it more difficult to assess the data provided by the cloud
service provider if it is structured in an unfamiliar way</p>
</li>
<li>
<p>it can become very hard to compare the security level of the cloud
service provider with the customer’s requirements or baseline,</p>
</li>
<li>
<p>it can make the comparison between offerings from different cloud
service providers impossible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One first step to address this issue is for cloud service providers to
adopt standardized metrics and reference them accordingly with a
well-known URL (i.e. using the referenceMetric property of the metric
resource). While necessary, standard metrics are often not enough. For
the purpose of comparing security attributes of a cloud service either
with a customer-defined baseline or with another competing cloud
service, it is useful to be much less flexible and to explicitly agree
to use a specific set of security attributes, asset categories, metrics
and measurement methods with detailed restrictions. To this end, CTP
defines <strong>service classes</strong> and <strong>asset classes</strong>. Both of these concepts
define a set of restrictions applicable to security attributes, metrics,
measurements and assets. They differ by their scope: while an asset
class applies a restriction to a particular asset, a service class
applies to a service-view and describes a restriction on all assets
within that service-view.</p>
</div>
<div class="paragraph">
<p>An asset class SHALL specify:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The type of asset targeted by the class of restrictions,</p>
</li>
<li>
<p>Asset naming conventions,</p>
</li>
<li>
<p>Metrics that can be used to create measurements on assets. The
specification of metrics includes at least:</p>
<div class="ulist">
<ul>
<li>
<p>Metric names,</p>
</li>
<li>
<p>The specification of (human readable) reference metrics,</p>
</li>
<li>
<p>The specification of metric measurement parameters,</p>
</li>
<li>
<p>The specification of measurement result formats</p>
</li>
</ul>
</div>
</li>
<li>
<p>Security attribute names and their applicable measurements/metrics,</p>
</li>
<li>
<p>The mandatory capabilities of measurements that apply a particular
metric (e.g. if the measurement must offer an objective, triggers, or be
user-activated).</p>
</li>
<li>
<p>Whether cryptographic signatures are mandatory or not for measurement
results.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A service class SHALL specify:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The type of service-view target by the class of restriction,</p>
</li>
<li>
<p>A series of asset-classes that apply to all the assets defined in the
type of service-view.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Service classes</strong> and <strong>asset classes</strong> are referenced in CTP by a
standardized URL, which MUST point to the document that defines the
previously outline information.</p>
</div>
<div class="paragraph">
<p>For example, we could imagine the definition of “asset class” for IaaS
<em>storage</em> assets (or similarly <em>compute</em> assets), where a predefined set
of attributes is standardized for objectives and measurement results,
using a well-defined set of industry wide agreed-upon metrics (i.e.
metrics, measurement result formats and measurement parameters). Such a
service class could for example require “availability” to be measured
with a measurement period of one month, the use of an uptime-based
measurement of “availability” with a “sample window size” of 2 minutes,
etc. A cloud provider that offers a storage resource API that adheres to
this service class would then reference the asset class URL in the CTP
representation of the asset: all security attributes (and related
measurements) that pertain to that asset would be expected to follow the
rules defined in the referenced asset class.</p>
</div>
<div class="paragraph">
<p>The definition of the exact content of these “service classes” or “asset
classes” is sector specific and is beyond the scope of this CTP Model
and API specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="relating-measurement-results-and-metrics">4.4. Relating measurement results and metrics</h3>
<div class="paragraph">
<p>In the CTP API, measurement results are presented as part of the result
returned when <a href="#measurements">querying a measurement</a>. This result is an
object that contains two key properties: (1) <code>value</code>, which is a table
describing the actual value of the measurement result and (2) <code>updateTime</code>,
which is a timestamp of the measurement result. The format of the table
describing the value is not fixed: it depends on the metric referenced
in the measurement. The referenced metric contains a field resultFormat
that describes the format of the result, as illustrated on the <a href="#figure-metrics-vs-measurements">figure</a>
below.</p>
</div>
<div id="figure-metrics-vs-measurements" class="imageblock">
<div class="content">
<img src="media/MetricsAndMeasurements.png" alt="image" width="640">
</div>
<div class="title">Figure 1. Relating measurement results format and values.</div>
</div>
<div class="paragraph">
<p>To better understand the link between the <code>resultFormat</code> property in CTP
API metrics and the value property of a CTP API measurement, we will
examine 3 examples.</p>
</div>
<div id="example-A" class="exampleblock">
<div class="title">Example 12. (A) Single value</div>
<div class="content">
<div class="paragraph">
<p>In the simplest case, when a measurement result can be
summarized into a single value (a number), the measurement result will
simply be a table containing a unique column, which itself contains a
unique row with one cell, as illustrated below:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:25%; ">
<colgroup>
<col style="width:100%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Percentage</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">99.0</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>The metric corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "resultFormat": [
        {
            "name": "percentage",
            "type": "number"
        }
    ],
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The measurement corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "result": {
        "value": [
            {
                "percentage": 99.0
            }
        ],
        ...
    },
    ...
}</code></pre>
</div>
</div>
</div>
</div>
<div id="example-B" class="exampleblock">
<div class="title">Example 13. (B) Multi-column value</div>
<div class="content">
<div class="paragraph">
<p>In more complex cases, a measurement result might be
represented as a set of values: for example, we could imagine a security
attribute describing the total number of requests made to a service
(“requestTotal”) as well as the total number of requests that failed
(“failedTotal”). In that case, the measurement result will be a table
containing two columns named “requestTotal” and “failedTotal”
respectively, with one row holding the values of these elements, as
illustrated in the example below:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:33%; ">
<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>requestTotal</strong></th>
<th class="tableblock halign-left valign-top"><strong>failedTotal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">130</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>The metric corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "resultFormat": [
        {
            "name": "requestTotal",
            "type": "number"
        },
        {
            "name": "failedTotal",
            "type": "number"
        }
    ],
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The measurement corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "result": {
        "value": [
            {
                "requestTotal": 130,
                "failedTotal": 3
            }
        ],
        ...
    },
    ...
}</code></pre>
</div>
</div>
</div>
</div>
<div id="example-C" class="exampleblock">
<div class="title">Example 14. (C) Multi-line complex values</div>
<div class="content">
<div class="paragraph">
<p>Finally, if needed, a measurement result can be a
represented as a bi-dimensional table, simply extending the previous
cases with multiple rows, as shown in the example below:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:50%; ">
<colgroup>
<col style="width:33%;">
<col style="width:33%;">
<col style="width:33%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>date</strong></th>
<th class="tableblock halign-left valign-top"><strong>code</strong></th>
<th class="tableblock halign-left valign-top"><strong>level</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2013-01-01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2013-01-02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2013-01-03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>The metric corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "resultFormat": [
        {
            "name": "date",
            "type": "string"
        },
        {
            "name": "code",
            "type": "number"
        },
        {
            "name": "level",
            "type": "number"
        }
    ],
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The measurement corresponding to this example will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    ...
    "result": {
        "value": [
            {
                "date": "2013-01-01",
                "code": 1,
                "level": 2
            },
            {
                "date": "2013-01-02",
                "code": 1,
                "level": 3
            },
            {
                "date": "2013-01-03",
                "code": 7,
                "level": 1
            }
        ],
        ...
    },
    ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In summary, measurement results are represented as a table, which is
composed of rows and named columns. CTP allows the user to query both
the definition of that table and the values stored inside of that table:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Table column names are provided as part of the metric description.</p>
</li>
<li>
<p>Table values are provided as part of measurement result.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Conditions that appear in “triggers” or “objectives”
are described with <a href="#ctpscript">CTPScript</a> (JavaScript-like) expressions that
reference the measured value of an attribute in a array called “value”.</p>
</div>
<div class="paragraph">
<p>The corresponding CTPScript expression to <a href="#example-A">(A) Single value</a> above will be a
table value of one element, which itself has only one property
“percentage”. A &#8220;pseudo-JavaScript&#8221; declaration of that table would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">value = [ { percentage: 99.0 } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, for <a href="#example-B">(B) Multi-column value</a> we would have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">value = [ { requestTotal: 130, failedTotal: 3 } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, for <a href="#example-C">(C) Multi-line complex values</a>, the expression would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">value = [ { date: “2013-01-01”, code: 1, level: 2 },
          { date: “2013-01-02”, code: 1, level: 3 },
          { date: “2013-01-03”, code: 7, level: 7 } ]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-api">5. The API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This part of the document specifies the RESTful API of CTP and is
divided in 4 parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#application-of-restful-principles">Sub-section 5.1</a> describes the RESTful principles used throughout the
CTP API.</p>
</li>
<li>
<p><a href="#specification-of-the-api-calls">Sub-section 5.2</a> specifies the API calls used in CTP, describing the
available RESTful operations (GET, PUT, POST and DELETE) for each API
resource and their effect.</p>
</li>
<li>
<p><a href="#evaluating-triggers-and-objectives">Sub-section 5.3</a> describes when conditional expressions in triggers and
objectives should be evaluated.</p>
</li>
<li>
<p><a href="#ctpscript">Sub-section 5.4</a> specifies the CTPScript language used to specify
conditional expressions in objectives and triggers.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="application-of-restful-principles">5.1. Application of RESTful principles</h3>
<div class="sect3">
<h4 id="_http_methods">5.1.1. HTTP methods</h4>
<div class="paragraph">
<p>A RESTful API is typically structured around “resources” which are
manipulated with HTTP methods such as GET, PUT, POST and DELETE
depending on the case.</p>
</div>
<div class="paragraph">
<p>In CTP the following principles are applied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A GET request is used to get information about a resource. GET
requests never make a change to the underlying resource.</p>
</li>
<li>
<p>A PUT request is used to modify part of a resource.</p>
</li>
<li>
<p>A POST request is used to create a resource. The created
resource MUST be identified with a <a href="#self-property">self-link</a> in the response.</p>
</li>
<li>
<p>A DELETE request is used to delete a resource.</p>
</li>
<li>
<p>All resources MUST have a different URL path. Query strings are not
used to distinguish resources, but are used to access or modify a part
of a resource through GET or PUT.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="application-of-hateoas">5.1.2. Application of HATEOAS</h4>
<div class="paragraph">
<p>CTP only partially applies the HATEOAS (Hypertext As The Engine Of
Application State) REST principle, providing descriptions of key links
between resources as URLs, when relevant.</p>
</div>
</div>
<div class="sect3">
<h4 id="content-type">5.1.3. Content type</h4>
<div class="paragraph">
<p>All requests and responses that contain a body MUST specify the
<code>application/json</code> as content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="status-codes">5.1.4. Status codes</h4>
<div class="paragraph">
<p>As a RESTful API, CTP follows the HTTP standard and must return a
relevant status code in responses to requests. In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A successful GET or PUT request SHALL return the status code <strong>200</strong>.</p>
</li>
<li>
<p>A successful POST request SHALL return status code <strong>201</strong>.</p>
</li>
<li>
<p>A successful DELETE request SHALL return status code <strong>204</strong>, with an
empty body.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unsuccessful requests MUST return appropriate status codes, and in
particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>400</strong> for malformed requests (e.g. a resource identifier that uses
characters outside the authorized alphabet).</p>
</li>
<li>
<p><strong>403</strong> for GET/PUT/POST/DELETE requests to a CTP resource that exists but
is not accessible to the user.</p>
</li>
<li>
<p><strong>404</strong> for requests to CTP resources that do not exist.</p>
</li>
<li>
<p><strong>405</strong> for any request to a CTP resource with a method (GET, PUT, etc.)
that is not defined in this specification.</p>
</li>
<li>
<p><strong>409</strong> for any PUT request on a valid CTP resource that conflicts with
the current state of the resource.</p>
</li>
<li>
<p><strong>500</strong> for internal failure in the CTP server (e.g. database connection
failure).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the CTP server uses a HTTP authentication mechanism (see <a href="#security-considerations">Security considerations</a>),
then the server SHOULD return status code 401 in case of an
authentication failure.</p>
</div>
</div>
<div class="sect3">
<h4 id="error-response-bodies">5.1.5. Error response bodies</h4>
<div class="paragraph">
<p>In case of an error, in addition to setting an appropriate status code,
a CTP Server SHALL send a JSON body containing a human readable error
message, encoded as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "error": string
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:%;">
<col style="width:%;">
<col style="width:%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A human readable description of the error.</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>Note that error messages MUST not contain the self property.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="specification-of-the-api-calls">5.2. Specification of the API calls</h3>
<div class="paragraph">
<p>Using <a href="#api-resources-urls">previously</a> introduced notation, the following list summarizes all the
valid API calls that are defined in the specification in the following
sections:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:10%;">
<col style="width:80%;">
<col style="width:10%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">URL</th>
<th class="tableblock halign-left valign-top">Query string</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews/{id}/dependencies</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews/{id}/assets</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/assets/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/assets/{id}/attributes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/attributes/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/attributes/{id}/measurements</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/measurements/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/metrics</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/metrics/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/triggers/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/dependencies/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews/{id}/logs</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/logs/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PUT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/measurement/{id}?x=state</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Yes</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>POST</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/serviceViews/{id}/triggers</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>DELETE</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>{CtpBase}/triggers/{id}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No</p>
</div></div></td>
</tr>
</tbody>
</table>

<div class="sect3">
<h4 id="get-ctpbase">5.2.1. GET {CtpBase}</h4>
<div class="sect4">
<h5 id="_description_2">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}</code> provides the information about the CTP
server.</p>
</div>
<div class="paragraph">
<p>CTP servers may either make this information accessible to anybody or
may restrict to authenticated CTP clients.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#ctpbase">JSON encoded CTP server information</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-serviceviews">5.2.2. GET {CtpBase}/serviceViews</h4>
<div class="sect4">
<h5 id="_description_3">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/serviceViews</code> provides a
collection of references to the service-views that are accessible to the
current CTP client.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this collection if it applies
to <strong>service-views</strong> that the CTP client is authorized to
access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_2">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_2">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_2">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/serviceViews/{id}/serviceViews</code></p>
</li>
<li>
<p>collectionType = “serviceViews”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-serviceunits-id">5.2.3. GET {CtpBase}/serviceViews/{id}</h4>
<div class="sect4">
<h5 id="_description_4">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/serviceViews/{id}</code> provides
information about the service-view identified by a <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to a service-view if it applies
to a <strong>service-view</strong> that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_3">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_3">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_3">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#service-views-encoding">service-view</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-serviceunits-id-dependencies">5.2.4. GET {CtpBase}/serviceViews/{id}/dependencies</h4>
<div class="sect4">
<h5 id="_description_5">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/serviceViews/{serviceUnit}/dependencies</code>
provides a collection of references to internal or external
service-views that the current service-view relies on to provide its
services.</p>
</div>
<div class="paragraph">
<p>Among these dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This query MUST provide references to all service-views provided by
the same provider.</p>
</li>
<li>
<p>This query SHOULD provide references to service-views provided by
third parties in the cloud supply chain, if such dependencies exist (see
discussion in <a href="#supply-chain">Annex</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The service-view dependencies provided by this query operation are
unqualified: there is no distinction between service-views that are
strictly necessary from service-views that are optional or used as a
backup. All direct dependencies should be listed in order to provide
transparency on the supply chain.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this collection if it applies
to a <strong>service-view</strong> that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_4">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_4">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_4">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/serviceViews/{serviceUnit}/dependencies</code></p>
</li>
<li>
<p>collectionType = “serviceViews” (not “dependencies”)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-serviceunits-id-assets">5.2.5. GET {CtpBase}/serviceViews/{id}/assets</h4>
<div class="sect4">
<h5 id="_description_6">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase/serviceViews/{id}/assets</code>
provides a collection of references to the assets managed by a specific
service-view (identified by <code>{id}</code>).</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this collection if it applies
to a <strong>service-view</strong> that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_5">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_5">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_5">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/serviceViews</code></p>
</li>
<li>
<p>collectionType = “assets”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-assets-id">5.2.6. GET {CtpBase}/assets/{id}</h4>
<div class="sect4">
<h5 id="_description_7">Description</h5>
<div class="paragraph">
<p>For any asset identified by a <code>{id}</code>, A <strong>GET</strong> request to
<code>{CtpBase}/assets/{id}</code> provides information about the asset
identified by a <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to an asset when it is part of a
service-view that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_6">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_6">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_6">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#assets-encoding">asset</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-assets-id-attributes">5.2.7. GET {CtpBase}/assets/{id}/attributes</h4>
<div class="sect4">
<h5 id="_description_8">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/assets/{id}/attributes</code> provides a
collection of references to the security attributes that apply to a
specific asset (identified by <code>{id}</code>).</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this collection if it applies
to an <strong>asset</strong> that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_7">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_7">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_7">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/assets/{id}/attributes</code></p>
</li>
<li>
<p>collectionType = “attributes”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-attributes-id">5.2.8. GET {CtpBase}/attributes/{id}</h4>
<div class="sect4">
<h5 id="_description_9">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/attributes/{id}</code> provides the
information relate to the attribute identified by a <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to an attribute when it applies
to an asset that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_8">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_8">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_8">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#attributes-encoding">attribute</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-attributes-id-measurements">5.2.9. GET {CtpBase}/attributes/{id}/measurements</h4>
<div class="sect4">
<h5 id="_description_10">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/attributes/{id}/measurements</code>
provides a collection of references to the measurements that are
available for a specific attribute (identified by <code>{id}</code>).</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this information if the CTP
client is authorized to access the identified <strong>attribute</strong>.</p>
</div>
<div class="paragraph">
<p>If the measurement contains an objective, it MUST be evaluated according
to the <a href="#evaluating-objectives">rules</a> defined in this document.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_9">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_9">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_9">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/attributes/{id}/measurements</code></p>
</li>
<li>
<p>collectionType = “measurements”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-measurements-id">5.2.10. GET {CtpBase}/measurements/{id}</h4>
<div class="sect4">
<h5 id="_description_11">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/measurement/{id}</code> provides the
information related to the measurement identified by a <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to a measurement when it applies
to an attribute that the CTP client is authorized to access.</p>
</div>
<div class="paragraph">
<p>Measurement results MUST be formatted
<a href="#relating-measurement-results-and-metrics">according to the referenced metric</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_10">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_10">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_10">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#measurements-encoding">measurement</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="put-measurements-id-state">5.2.11. PUT {CtpBase}/measurements/{id}?x=state`</h4>
<div class="sect4">
<h5 id="_description_12">Description</h5>
<div class="paragraph">
<p>For measurements that have the capability to be user-activated only, a
<strong>PUT</strong> request to <code>{CtpBase}/measurments/\{measurements}/?x=state</code> will
change the state of the measurement according to the request body,
either to activate or deactivate a measurement.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only allow this modification for a <strong>measurement</strong> that
the CTP client is authorized to access.</p>
</div>
<div class="paragraph">
<p>This additional interface is used for cloud user-activated measurements,
such as the triggering of a vulnerability scan. For example, in an IaaS
setup, the cloud client could execute a HTTP <strong>PUT</strong> request to the
“vulnerability-count” measurement for an attribute of a resource
representing a particular instance he’s interested in. Once the scan is
complete, its results will be accessible through the measurement result
query interface described later in this document. Only a limited number
of measurements are likely to be “client initiated”.</p>
</div>
<div class="paragraph">
<p>If the measurement does not have the capability to be client initiated,
the server should return status code 409 (Conflict).</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_11">Request query string</h5>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Query parameter name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>x</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The string “state”.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
<div class="sect4">
<h5 id="_request_body_11">Request body</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "state": string
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>state</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Either “activated” or “deactivated”</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
<div class="sect4">
<h5 id="_response_body_11">Response body</h5>
<div class="paragraph">
<p>The response body is an updated JSON representation of the <a href="#measurements-encoding">measurement</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-metrics">5.2.12. GET {CtpBase}/metrics</h4>
<div class="sect4">
<h5 id="_description_13">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/metrics</code> provides a collection of
references to the metrics that are recognized by the CTP sever. This
should include all metrics that can be used in measurements.</p>
</div>
<div class="paragraph">
<p>CTP servers may either make this collection accessible to anybody or may
restrict it to authenticated users.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_12">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_12">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_12">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/metrics</code></p>
</li>
<li>
<p>collectionType = “metrics”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-metrics-id">5.2.13. GET {CtpBase}/metrics/{id}</h4>
<div class="sect4">
<h5 id="_description_14">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/metrics/{id}</code> provides the
information related to the metric identified by a <code>{id}</code>.</p>
</div>
<div class="paragraph">
<p>CTP servers may either make a metric accessible to anybody or may
restrict it to authenticated users.</p>
</div>
<div class="paragraph">
<p>The relationship between measurement and metrics is detailed in <a href="#relating-measurement-results-and-metrics">Relating measurement results and metrics</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_13">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_13">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_13">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#metrics-encoding">metric</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-views-id-triggers">5.2.14. GET {CtpBase}/serviceViews/{id}/triggers</h4>
<div class="sect4">
<h5 id="_description_15">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/serviceViews/{id}/triggers</code> provides a
collection of references to the triggers that are accessible in a service-view
(identified by <code>{id}</code>).</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to this collection if it applies
to <strong>triggers</strong> in a <strong>service-view</strong> that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_14">Request query string</h5>
<div class="paragraph">
<p>Uses optional <a href="#collections">items and page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_14">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_14">Response body</h5>
<div class="paragraph">
<p>Returns a <a href="#collections">collection</a>, with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>self = <code>{CtpBase}/serviceViews/{id}/triggers</code></p>
</li>
<li>
<p>collectionType = “triggers”</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-triggers-id">5.2.15. GET {CtpBase}/triggers/{id}</h4>
<div class="sect4">
<h5 id="_description_16">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/triggers/{id}</code> enables reading
information about the trigger identified by <code>{id}</code>. While triggers
are defined by CTP clients through a <a href="#post-views-id-triggers">POST request</a>,
this GET request allows querying the content of previously created
triggers.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to a trigger if it is part of a
<strong>service-view</strong> that the CTP client is authorized to access.</p>
</div>
<div class="paragraph">
<p>Triggers MUST be evaluated according to the rules defined in <a href="#evaluating-triggers">Evaluating triggers</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_15">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_15">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_15">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#triggers">trigger</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="post-views-id-triggers">5.2.16. POST {CtpBase}/serviceViews/{id}/triggers</h4>
<div class="sect4">
<h5 id="_description_17">Description</h5>
<div class="paragraph">
<p>A trigger can be created with a <strong>POST</strong> request to
<code>{CtpBase}/serviceViews/{id}/triggers</code>.</p>
</div>
<div class="paragraph">
<p>This <strong>POST</strong> request will only succeed for measurements that hold the
capability to provide triggers (i.e. the <code>triggers</code> <a href="#triggers-encoding">property</a> in the
<a href="#measurements">measurement</a> must not be null)</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only allow creating a <strong>trigger</strong> within a <strong>service-view</strong> that
the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_16">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_16">Request body</h5>
<div class="paragraph">
<p>The request body MUST be encoded as a normal <a href="#triggers-encoding">triggers</a> but without the
self property.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_16">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#triggers-encoding">trigger</a>.</p>
</div>
<div class="paragraph">
<p>The HTTP response code MUST be 201 if the trigger was successfully
created. The self property provided in the response indicates the
location of the newly created trigger, which can be accessed through GET
or removed through DELETE.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="delete-triggers-id">5.2.17. DELETE {CtpBase}/triggers/{id}</h4>
<div class="sect4">
<h5 id="_description_18">Description</h5>
<div class="paragraph">
<p>A <strong>DELETE</strong> request to <code>{CtpBase}/triggers/{id}</code> removes the
specified trigger.</p>
</div>
<div class="paragraph">
<p>CTP servers SHALL only allow removing a <strong>trigger</strong> within a <strong>view</strong> that
the CTP client is authorized to access</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_17">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_17">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_17">Response body</h5>
<div class="paragraph">
<p>None. HTTP status code 204 is returned if the delete operation succeeds.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="get-views-id-logs">5.2.18. GET {CtpBase}/serviceViews/{id}/logs</h4>
<div class="sect4">
<h5 id="_description_19">Description</h5>
<div class="paragraph">
<p>A <strong>GET</strong> request to <code>{CtpBase}/view/{id}/logs</code> provides a collection
of references to log entries that have been recorded for a client of the
CTP server as the result of a trigger evaluation following the rules
in <a href="#evaluating-triggers">Evaluating triggers</a>. The references MUST be ordered chronologically.
Request parameters can be used to limit the number of log entry
references returned in the response.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_18">Request query string</h5>
<div class="paragraph">
<p>The request query string uses optional <a href="#collections">items and page</a>,
but is extended with additional elements as follows.</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Query parameter name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>Optional</em> page number, represented as an integer
greater or equal to 0 (see <a href="#collections">[collections]</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>items</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>Optional</em> number of elements returned in the
collection, represented as an integer greater than 0. (see <a href="#collections">[collections]</a>)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>oldest</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional <a href="#RFC_3339">[RFC_3339]</a> UTC timestamp for the oldest log entry
that can be returned. Only logs as old or newer than that date/time are
returned if this parameter is specified.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>newest</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>datetime</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional <a href="#RFC_3339">[RFC_3339]</a> UTC timestamp for the newest log entry
that can be returned. Only logs strictly older than that date/time are
returned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tags</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An optional <em>string</em> representing a set of
comma-separated tags. It selects only log entries that matching all the
tags. When omitted, log entries are selected regardless of
their tag.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
<div class="sect4">
<h5 id="_request_body_18">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_18">Response body</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">{
    "self": URL,
    "collectionLength": number,
    "returnedLength": number,
    "collectionType": string,
    "collection": [
        URL, ...
    ]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:12%;">
<col style="width:62%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>self</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>URL</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="#self-property">Self-reference</a> <code>{CtpBase}/serviceViews/{id}/dependencies</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collectionLength</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The total number of elements in the
collection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>returnedLength</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>number</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The total number of elements returned in the
collection in the response, which will be equal to collectionLength or
less, depending on the use of the query string parameters page and
items.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collectionType</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The string “serviceViews” (not
“dependencies”)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collection</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><em>list</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of distinct links, each of the form
“<code>{CtpBase}/serviceViews/{serviceUnit}</code>”.</p>
</div></div></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect3">
<h4 id="get-logs-id">5.2.19. GET {CtpBase}/logs/{id}</h4>
<div class="sect4">
<h5 id="_description_20">Description</h5>
<div class="paragraph">
<p>CTP exposes a RESTful interface to access individual alert records
generated by triggers. A <strong>GET</strong> request to <code>{CtpBase}/logs/{id}</code>
returns an individual log entry (identified by <code>{id}</code>), which notably
contains the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="#self-property">self-reference</a> to this resource.</p>
</li>
<li>
<p>A reference to the trigger that resulted in the creation of this log
entry.</p>
</li>
<li>
<p>The date and time the log entry was created.</p>
</li>
<li>
<p>The copy of the measurement result that resulted in the trigger
condition being true.</p>
</li>
<li>
<p>The tag that was associated with the trigger.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CTP servers SHALL only provide access to a log entry if it is part of
a service-view that the CTP client is authorized to access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_query_string_19">Request query string</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_body_19">Request body</h5>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_body_19">Response body</h5>
<div class="paragraph">
<p>Returns a JSON encoded <a href="#log-entries">log entry</a>.
depending on the type of log entry.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="evaluating-triggers-and-objectives">5.3. Evaluating triggers and objectives</h3>
<div class="sect3">
<h4 id="evaluating-objectives">5.3.1. Evaluating objectives</h4>
<div class="paragraph">
<p>An objective also applies to the result of a measurement. An objective
condition may either be evaluated:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Each time a measurement result is updated, or</p>
</li>
<li>
<p>Each time a cloud service customer accesses the corresponding
objective CTP RESTful resource.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both approaches provide the same result from the point of view of the
CTP user.</p>
</div>
</div>
<div class="sect3">
<h4 id="evaluating-triggers">5.3.2. Evaluating triggers</h4>
<div class="paragraph">
<p>A trigger condition MUST be evaluated each time a new measurement result
is available. The processing of triggers is governed by the rules
defined in the <a href="#alert-rules">pseudo-code</a> below, and depends on the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>trigger.status</code>: The current status of the trigger.</p>
</li>
<li>
<p><code>trigger.statusUpdateTime</code>: A timestamp of the last status update of the trigger.</p>
</li>
<li>
<p><code>NOW</code>: the current UTC date and time.</p>
</li>
</ul>
</div>
<div id="alert-rules" class="listingblock">
<div class="title">Trigger processing rules.</div>
<div class="content">
<pre class="highlight"><code class="java language-java">// pseudo-code

switch (trigger.status) {

    case "true":
        if ( NOW-trigger.statusUpdateTime &gt; trigger.guardTime ) {
            Evaluate trigger.condition
            Update trigger.status and trigger.statusUpdateTime
            if (trigger.status=="error") {
                Generate error log entry
                Send XMPP notification
            }
            if (trigger.status=="true") {
                Generate normal log entry
                Send XMPP notification
            }
        } else {
            Do nothing
        }

    case "false":
        Evaluate trigger condition
        Update trigger.status and trigger.statusUpdateTime
        if (trigger.status=="error") {
            Generate error log entry
            Send XMPP notification
        }
        if (trigger.status=="true") {
            Generate normal log entry
            Send XMPP notification
        }

    case "error":
        Do nothing // note: trigger must be corrected first to remove error.
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ctpscript">5.4. CTPScript: a condition description language</h3>
<div class="paragraph">
<p>Conditions used in both objectives and triggers are described with
CTPScript: a language that is modeled after JavaScript expressions, with
many simplifications that are designed to facilitate implementation. We
highlight in particular that CTPScript is limited to statements
representing expressions and does not include any other language
construct (such as assignments, control structures, declarations,
prototypes, etc.).</p>
</div>
<div class="paragraph">
<p>CTPScript expressions mainly operate on a 4 variables, which represent
the 4 fields of a <a href="#results">measurement result</a>. The most important variable
is <code>value</code>, a table of objects that represent a measured value.</p>
</div>
<div class="exampleblock">
<div class="title">Example 15. CTP expressions in triggers</div>
<div class="content">
<div class="paragraph">
<p>The following are further examples of CTPScript Expression that could be provided in triggers or
conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">value[0].percentage &lt;= 99.0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">(timeUTC("now")-toTimeUTC(updateTime)&lt;3600)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">matchRegex(“UK”, select(result, "country"))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="basic-grammar">5.4.1. Basic Grammar</h4>
<div class="paragraph">
<p>The following rules describe the CTPScript grammar, with some further
details provided in the following sub-sections. A CTPScript expression
is defined by the <strong>Expr</strong> token in the grammar below. A CTPScript
expression <strong>Expr</strong> is considered true if <code>toBoolean(Expr)</code> returns true,
and false otherwise, taking the definition of <code>toBoolean</code> <a href="#toboolean">below</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">    Expr:
        Literal
        Identifier
        Expr "&amp;&amp;" Expr
        Expr "||" Expr
        Expr "&lt;" Expr
        Expr "&lt;=" Expr
        Expr "&gt;" Expr
        Expr "&gt;=" Expr
        Expr "!=" Expr
        Expr "==" Expr
        Expr "+" Expr
        Expr "-" Expr
        Expr "/" Expr
        Expr "*" Expr
        Expr "%" Expr
        "-" Expr
        "!" Expr
        "(" Expr ")"
        FunctionCall

    Literal:
        StringLiteral
        NumericLiteral
        ArrayLiteral
        ObjectLiteral
        "true"
        "false"
        "null"

    Identifier:
        IdentifierName
        Identifier "[" Expr "]"
        Identifier "." IdentifierName

    FunctionCall:
        Identifier "(" ")"
        Identifier "(" ParameterList ")"

    ParameterList:
        Expr
        ParameterList "," Expr

    ObjectLiteral:
        "{" "}"
        "{" ObjectElements "}"

    ArrayLiteral:
        "[" "]"
        "[" ArrayElements "]"

    ArrayElements:
        Expr
        ArrayElements "," Expr

    ObjectElements:
        ObjectElementItem
        ObjectElements, ObjectElementItem

    ObjectElementItem:
        IdentifierName ":" Expr
        StringLiteral ":" Expr

</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="definitions-borrowed-from-other-standards">5.4.2. Definitions borrowed from other standards</h4>
<div class="paragraph">
<p>CTPScripts borrow a few definitions form existing freely available
standards, in particular <a href="#ECMA_262">[ECMA_262]</a> version 5 (i.e. Javascript).</p>
</div>
<div class="sect4">
<h5 id="stringliteral">StringLiteral</h5>
<div class="paragraph">
<p>A UTF8 string quoted with simple or double quotes as defined in ECMA 262
v5, in clause 7.8.4.</p>
</div>
<div class="paragraph">
<p>Note that CTPScript represents string in UTF-8 format, not UTF-16 as in javascript.</p>
</div>
</div>
<div class="sect4">
<h5 id="numericliteral">NumericLiteral</h5>
<div class="paragraph">
<p>A double precision 64-bit format IEEE 754 floating point as defined in
ECMA 262 v5, in clause 7.8.3.</p>
</div>
</div>
<div class="sect4">
<h5 id="identifiername">IdentifierName</h5>
<div class="paragraph">
<p>An IdentifierName as defined in ECMA 262 v5, in clause 7.6.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="types">5.4.3. Types</h4>
<div class="sect4">
<h5 id="the-7-types-of-ctpscript">The 7 types of CTPScript</h5>
<div class="paragraph">
<p>There are 7 types defined in CTPScript:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>string</strong>: A UTF8 character string.</p>
</li>
<li>
<p><strong>number</strong>: A double precision 64-bit format IEEE 754 floating point
number, which is used also to represent integers.</p>
</li>
<li>
<p><strong>boolean</strong>: A type that represents either true or false.</p>
</li>
<li>
<p><strong>null</strong>: A type that represents a null or undefined value.</p>
</li>
<li>
<p><strong>objects</strong>: A type that represents a list of fields as (key, value)
pairs (a simplified Javascript object).</p>
</li>
<li>
<p><strong>arrays</strong>: A type that represents a list of values indexed by a integral
number (a simplified Javascript array). CTPScript arrays have one property
<em>length</em>, which represents the highest existing index in the array, plus one.</p>
</li>
<li>
<p><strong>function</strong>: A type that represents a function.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We call <strong>integral number</strong> the subset of numbers that can be represented
as an integer in the range -2<sup>31</sup> and 2<sup>31</sup>-1, inclusive. This type does
not explicitly exist in CTPScript but is useful to define some elements
in this specification.</p>
</div>
<div class="paragraph">
<p>Note that CTPScript does not provide the <strong>undefined</strong> type that exists in javascript.</p>
</div>
</div>
<div class="sect4">
<h5 id="the-typeof-pseudo-function">The typeOf() pseudo-function</h5>
<div class="paragraph">
<p>For any value <strong>a</strong> represented in CTPScript, we define a pseudo-function
<code>typeOf(a)</code> which returns a string representing the type of <strong>a</strong> (e.g.
“string”, “number”, “boolean”, "null", "object", "array" or "function"). The implementation of the
pseudo-function <code>typeOf()</code> is not required: it is only defined to
facilitate the description of this specification.</p>
</div>
</div>
<div class="sect4">
<h5 id="the-getfield-pseudo-function.">The getField() pseudo-function.</h5>
<div class="paragraph">
<p>For the purpose of this specification, we define the pseudo-function
<code>getField(a, prop)</code> which takes as first argument an array or object <strong>a</strong>,
and as second argument a string or an integral number <strong>prop</strong>, and
returns the value associated with the key <strong>prop</strong> in the array or object
if it exists or <strong>null</strong> otherwise.</p>
</div>
<div class="paragraph">
<p>The implementation of the pseudo-function <code>getField()</code> is not required: it
is only defined to facilitate the description of this specification.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="functions">5.4.4. Functions</h4>
<div class="paragraph">
<p>CTPScript only defines 8 functions or methods, which are detailed hereafter.</p>
</div>
<div class="paragraph">
<p>Note that all CTP Arrays also define the special property <code>length</code> as
specified in <a href="#the-7-types-of-ctpscript">The 7 types of CTPScript</a></p>
</div>
<div class="sect4">
<h5 id="tostring">toString(a): string</h5>
<div class="paragraph">
<p>The function <code>toString</code> converts its argument <strong>a</strong> to a string as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <strong>a</strong> is a string return <strong>a</strong></p>
</li>
<li>
<p>If <strong>a</strong> is a number return a string representation of a as would be
returned by the “%e” specifier in the C standard function <code>sprintf()</code> (as
defined in ISO C99).</p>
</li>
<li>
<p>If <strong>a</strong> is a Boolean return <code>"true"</code> if <strong>a</strong> is true, <code>"false"</code> otherwise.</p>
</li>
<li>
<p>If <strong>a</strong> is null or an empty array, return an empty string.</p>
</li>
<li>
<p>If <strong>a</strong> is an object, return the string <code>"[Object Undefined]"</code>.</p>
</li>
<li>
<p>If <strong>a</strong> is an (non-empty) array:
6.1. Let r be initialized with the value of <code>toString(GetField(a,0))</code>
6.2. For i = 1 to <code>GetField(a,"length")-1</code> do
6.2.1. Concatenate the string "," to r
6.2.2. Concatenate the string <code>toString(GetField(a,i))</code> to r
6.3. Return the string r.</p>
</li>
<li>
<p>If <strong>a</strong> is a function return the string <code>"function &lt;id&gt;() { [Native code] }"</code>, where <code>&lt;id&gt;</code>
is replaced by the name of the function.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="toboolean">toBoolean(a): Boolean</h5>
<div class="paragraph">
<p>The function <code>toBoolean</code> converts its argument <strong>a</strong> to a boolean as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <strong>a</strong> is a string return <code>false</code> if <strong>a</strong> is the empty string, and <code>true</code>
otherwise.</p>
</li>
<li>
<p>If <strong>a</strong> is a number return <code>false</code> if <strong>a</strong> is -0, +0, or NaN, and <code>true</code>
otherwise.</p>
</li>
<li>
<p>If <strong>a</strong> is a Boolean return <strong>a</strong>.</p>
</li>
<li>
<p>If <strong>a</strong> is <code>null</code>, return <code>false</code>.</p>
</li>
<li>
<p>If <strong>a</strong> is an object or an array return <code>true</code>.</p>
</li>
<li>
<p>If <strong>a</strong> is a function return <code>true</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="tonumber">toNumber(a): number</h5>
<div class="paragraph">
<p>The function <code>toNumber</code> converts its argument <strong>a</strong> to a number as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <strong>a</strong> is a string return the number that would be returned by
applying the standard C function <code>atof()</code> to the string <strong>a</strong> (as defined in
ISO C99).</p>
</li>
<li>
<p>If <strong>a</strong> is a number return <strong>a</strong>.</p>
</li>
<li>
<p>If <strong>a</strong> is a Boolean return 1 if <strong>a</strong> is true, 0 otherwise.</p>
</li>
<li>
<p>If <strong>a</strong> is null, return 0.</p>
</li>
<li>
<p>If <strong>a</strong> is an object or an array return NaN.</p>
</li>
<li>
<p>If <strong>a</strong> is a function return NaN.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="min">Array.min(): (any type)</h5>
<div class="paragraph">
<p>The method <code>min</code> returns the smallest value in an Array object as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Let <strong>t</strong> be the array to which we apply the <code>min</code> method.</p>
</li>
<li>
<p>If <strong>t</strong> is empty return <code>null</code>.</p>
</li>
<li>
<p>Let <strong>t[i]</strong> define any value that verifies <strong>t[i]</strong> <strong>&lt;=</strong> <strong>t[j]</strong> for any
<strong>i</strong> ≠ <strong>j</strong> (using the comparison operator <strong>&lt;=</strong> defined in <a href="#comparison-operators">Comparison Operators &lt;, &lt;=, &gt;, &gt;=, ==, !=</a>).</p>
</li>
<li>
<p>If there is only one index <strong>i</strong> that verifies the property in step 3,
return <strong>t[i].</strong></p>
</li>
<li>
<p>If there are several indices <strong>i</strong> that verify the property in step 3,
return the value <strong>t[i]</strong> with the smallest index <strong>i</strong> that verifies step 3.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="max">Array.max(): (any type)</h5>
<div class="paragraph">
<p>The method <code>max</code> returns the largest value in an Array object as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Let <strong>t</strong> be the array to which we apply the <code>max</code> method.</p>
</li>
<li>
<p>If <strong>t</strong> is empty return <code>null</code>.</p>
</li>
<li>
<p>Let <strong>t[i]</strong> define any value that verifies <strong>t[i]</strong> &gt;= <strong>t[j]</strong> for any
<strong>i</strong> ≠ <strong>j</strong> (using the comparison operator <strong>&gt;=</strong> defined in <a href="#comparison-operators">Comparison Operators &lt;, &lt;=, &gt;, &gt;=, ==, !=</a>).</p>
</li>
<li>
<p>If there is only one index <strong>i</strong> that verifies the property in step 3,
return <strong>t[i]</strong>.</p>
</li>
<li>
<p>If there are several indices <strong>i</strong> that verify the property in step 3,
return the value <strong>t[i]</strong> with the biggest index <strong>i</strong> that verifies step 3.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="matchRegex">matchRegexp(r, v): boolean</h5>
<div class="paragraph">
<p>The function <code>matchRegexp</code> verifies that the value <strong>v</strong> matches the regular
expression <strong>r</strong>, which must be a string representing a POSIX Extended
Regular
Expression <span class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnote_5" title="View footnote.">5</a>]</span>
(POSIX ERE). The value <strong>v</strong> can either be a string or an array of strings.
The function works as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(r)</code> is not "string" then abort raising an exception.</p>
</li>
<li>
<p>If <strong>r</strong> is not a correctly formed POSIX ERE, then abort raising an exception.</p>
</li>
<li>
<p>If <code>typeOf(a)</code> is not "array" then goto step 5.</p>
</li>
<li>
<p>If all integral number keys <strong>i</strong> of <strong>a</strong> verify <code>matchRegexp(r, GetField(a, i))</code> then return
<code>true</code>, otherwise return <code>false</code>.</p>
</li>
<li>
<p>If <code>typeOf(a)</code> is not "string" then abort raising a/n exception.</p>
</li>
<li>
<p>If <strong>s</strong> matches <strong>r</strong> according to POSIX ERE matching rules then return <code>true</code>,
otherwise return <code>false</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="select">select(s, a): table</h5>
<div class="paragraph">
<p>The function <code>select</code> iterates through an array <strong>a</strong> of objects
and returns an array that is created by selecting the key <strong>s</strong> in
each one of the objects of <strong>a</strong>.
The function operates as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is not "array" then abort raising an exception.</p>
</li>
<li>
<p>Let <strong>t</strong> be an array. For each index <strong>i</strong> representing an integral
number key in <strong>a</strong>, define <strong>t[i]</strong> as <code>getField(getField(a, i), s)</code>.</p>
</li>
<li>
<p>Return the array <strong>t</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="timeUTC">timeUTC(s): number</h5>
<div class="paragraph">
<p>The function <code>timeUTC</code> takes a string s and converts it to a number
representing the number of seconds since 00:00:00 UTC, January 1, 1970,
which is referred as the "epoch".</p>
</div>
<div class="paragraph">
<p>The string <strong>s</strong> must be either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An Internet Date/Time format as defined in RFC 3339 (e.g. "2015-07-20T12:34:56Z")</p>
</li>
<li>
<p>The string "now".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function operates as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(s)</code> is not a string then abort raising an exception.</p>
</li>
<li>
<p>If <strong>s</strong> is the string "now", return the current UTC time expressed as the number of seconds elapsed since the "epoch".</p>
</li>
<li>
<p>If <strong>s</strong> is an RFC 3339 date/time string representing a UTC date before the "epoch", return the corresponding UTC time expressed as a negative number of seconds before the "epoch".</p>
</li>
<li>
<p>If <strong>s</strong> is an RFC 3339 date/time string representing a UTC date equal or greater than the "epoch", return the corresponding UTC time expressed as a number of seconds elapsed since the "epoch".</p>
</li>
<li>
<p>In all other cases, abort raising an exception.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="boolean-operators">5.4.5. Boolean operators ||, &amp;&amp;</h4>
<div class="paragraph">
<p>The expression <code>a || b</code> is evaluated as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>toBoolean(a)</code> = <code>true</code> then return <strong>a</strong> else return <strong>b</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The expression <code>a &amp;&amp; b</code> is evaluated as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>toBoolean(a)</code> = <code>false</code> then return <strong>a</strong> else return <strong>b</strong>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
this approach is similar to the one used in Javascript
(ECMAScript) but is different from more traditional languages such as C
or Java.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="comparison-operators">5.4.6. Comparison Operators &lt;, &lt;=, &gt;, &gt;=, ==, !=</h4>
<div class="paragraph">
<p>Let <code>compareString(a,b)</code> be the pseudo-function that compares two UTF-8
strings in lexicographic order and returns (-1) if <strong>a</strong>&lt;*b*, (1) if <strong>a</strong>&gt;*b* and
(0) if <strong>a</strong> and <strong>b</strong> are equal. Comparison is done on the basis of the UTF
code unit values (not bytes).</p>
</div>
<div class="paragraph">
<p>The expression <code>a &lt; b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "string" and <code>typeOf(b)</code> is "string" return
<code>true</code> if <code>compareString(a,b)</code> equals -1</p>
</li>
<li>
<p>Let <strong>an</strong> = <code>toNumber(a)</code> and <strong>bn</strong>= <code>toNumber(b)</code></p>
</li>
<li>
<p>If <strong>an</strong> is <strong>NaN</strong> or <strong>bn</strong> is <strong>NaN</strong> return <code>false</code>.</p>
</li>
<li>
<p>Taking into account the canonical ordering of numbers, return <code>true</code>
if <strong>an &lt; bn</strong>, otherwise return <code>false</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a == b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "string" and <code>typeOf(b)</code> is "string" return
<code>true</code> if <code>compareString(a,b)</code> equals 0</p>
</li>
<li>
<p>Let <strong>an</strong> = <code>toNumber(a)</code> and <strong>bn</strong>= <code>toNumber(b)</code></p>
</li>
<li>
<p>If <strong>an</strong> is <strong>NaN</strong> or <strong>bn</strong> is <strong>NaN</strong> return <code>false</code>.</p>
</li>
<li>
<p>Taking into account the canonical ordering of numbers, return <code>true</code>
if <strong>an == bn</strong>, otherwise return <code>false</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a &lt;= b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Return the result of evaluating <code>( a&lt;b || a==b )</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a &gt;= b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Return the result of evaluating <code>( a&gt;b || a==b )</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a != b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Let <strong>r</strong> be the evaluation of <code>a == b</code></p>
</li>
<li>
<p>If <strong>r</strong> is <code>true</code> return <code>false</code>, otherwise return <code>true</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <strong>a &gt; b</strong> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Let <strong>r</strong> be the evaluation of <code>a &lt; b</code></p>
</li>
<li>
<p>If <strong>r</strong> is <code>true</code> return <code>false</code>, otherwise return <code>true</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="multiplicative-and-additive-binary-operators">5.4.7. Multiplicative and additive binary operators: +, -, *, /, %</h4>
<div class="paragraph">
<p>The expression <code>a + b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "string" and <code>typeOf(b)</code> is "string", return the
string formed by appending the string <strong>b</strong> to the end of <strong>a</strong>.</p>
</li>
<li>
<p>If <code>typeOf(a)</code> is number and <code>typeOf(b)</code> is "number", return the
numerical sum <strong>a</strong>+<strong>b</strong>, according to IEEE 754.</p>
</li>
<li>
<p>In all other cases, return NaN.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a - b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "number" and <code>typeOf(b)</code> is "number", return the
numerical subtraction <strong>a-b</strong>, according to IEEE 754.</p>
</li>
<li>
<p>In all other cases, return NaN.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a * b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "number" and <code>typeOf(b)</code> is "number", return the
numerical multiplication <strong>a</strong> * <strong>b</strong>, according to IEEE 754.</p>
</li>
<li>
<p>In all other cases, return NaN.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The expression <code>a / b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "number" and <code>typeOf(b)</code> is "number", return the
numerical division <strong>a</strong>/<strong>b</strong>, according to IEEE 754.</p>
</li>
<li>
<p>In all other cases, return NaN.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
Divisions by 0 return –Inf, +Inf, or NaN depending on the case, as specified in
IEEE 754.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The expression <code>a % b</code> is evaluated as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>typeOf(a)</code> is "number" and <code>typeOf(b)</code> is "number", return a
result equivalent to the computation of <code>fmod(a,b)</code> where <code>fmod</code> is a
standard C function, which computes the floating-point remainder of
dividing a by b (as defined in ISO C99).</p>
</li>
<li>
<p>In all other cases, return NaN.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="ctpscript-identifiers">5.4.8. Identifiers</h4>
<div class="paragraph">
<p>The CTPScript only defines 4 identifiers, corresponding to the 4 properties of
a measurement result as defined in <a href="#measurements-encoding">Encoding</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>value</code></p>
</li>
<li>
<p><code>updateTime</code></p>
</li>
<li>
<p><code>authorityId</code></p>
</li>
<li>
<p><code>signature</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The most important identifier is <code>value</code> which represents an “array of objects”
 or in other words a bi-dimensional table. This is an
immutable bi-dimensional table so in effect it acts as a constant. As
detailed in the section <a href="#relating-measurement-results-and-metrics">Relating measurement results and metrics</a>,
the table elements <code>value[0], value[1], &#8230;, value[n]</code>
represent a set of rows, while the fields of each individual <code>value[i]</code>
represent the cells of this bi-dimensional table. The field names that
are defined in each <code>value[i]</code> depend on the definition of the
measurement, as specified in the <code>resultFormat</code> <a href="#measurements-encoding">property of a measurement</a>.</p>
</div>
<div class="paragraph">
<p>The value of <code>updateTime</code> can be used in CTPScript expression to evaluate the date of the last
measurement of a security attribute, notably in combination with the CTPScript function <code>timeUTC</code>
(see <a href="#timeUTC">timeUTC(s): number</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="evaluating-ctpscript-expressions">5.4.9. Evaluating CTPScript expressions</h4>
<div class="paragraph">
<p>CTPScript expression are evaluated according to the timing rules defined in <a href="#evaluating-triggers-and-objectives">Evaluating triggers and objectives</a>.</p>
</div>
<div class="paragraph">
<p>The result of the evaluation of a CTPScript expression is always one of the three following values: <code>false</code>, <code>true</code> or <code>error</code>.</p>
</div>
<div class="paragraph">
<p>The evaluation MUST generate the value <code>error</code> if any of the following condition occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The CTPScript contains a syntax error.</p>
</li>
<li>
<p>The CTPScript calls a function that does not exist or attemps to access a field in a null variable.</p>
</li>
<li>
<p>A function used in the expression generates an exception.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementation SHOULD provide descriptive error information as part of the data logged as a consequence of an error (see <a href="#error-log-entries-encoding">Encoding of error log entries</a>).</p>
</div>
<div class="paragraph">
<p>In all other cases, the function <a href="#toboolean">toBoolean()</a> is applied to the result providing a final value that is equal to either <code>true</code> or <code>false</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-considerations">6. Security considerations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="four-security-requirements-for-the-ctp-api">6.1. Four security requirements for the CTP API</h3>
<div class="paragraph">
<p>The CTP API can be used to provide access to two types of data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Private data</strong> representing customer-specific or sensitive data.</p>
</li>
<li>
<p><strong>Public data</strong> that represent generic information about a cloud
service, excluding sensitive or customer-specific data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As described in the <a href="#the-ctp-data-model">CTP data model</a>, except for metrics, each
CTP API resource can be tied directly or indirectly to a service-view through a
hierarchy (e.g. an attribute is tied to an asset, which itself is tied
to a service-view, which is then implicitly tied to a customer). CTP therefore
uses the notion of a <a href="#service-views">service-view</a> to represent a limitation on the
scope of information accessible to a cloud customer. Each customer
should get a different service-view (or set of service-views) to access private data. Cloud providers MAY
also define an additional shared “public” service-view to access public data, which will not require
authentication.</p>
</div>
<div class="paragraph">
<p>In the remaining of this section, we only discuss the access to private
data and the security considerations that it entails.</p>
</div>
<div class="paragraph">
<p>In order to protect private data, implementation MUST satisfy the
following requirements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Requirement 1</dt>
<dd>
<p>Each API call to non-public data MUST carry authentication information
in order to establish that the client is authorized to access the resource
that is requested.</p>
</dd>
<dt class="hdlist1">Requirement 2</dt>
<dd>
<p>All communications between the CTP client and the
CTP server MUST be secured by a transport mechanism that offers both
confidentiality and integrity for the data exchanged, including the
authentication data from requirement 1.</p>
</dd>
<dt class="hdlist1">Requirement 3</dt>
<dd>
<p>All security mechanisms MUST be compatible with the
stateless nature of the CTP RESTful API. Session information should not
be maintained across consecutive CTP API calls.</p>
</dd>
<dt class="hdlist1">Requirement 4</dt>
<dd>
<p>The security mechanisms MUST preserve the API
defined in this specification, including URL formats, query strings and
JSON data structures. The security mechanism MAY however result in the addition or
modification of HTTP headers that are part of the RESTful API requests.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Implementers are free to choose any set of security mechanisms that
verifies the 4 requirements above. However, for interoperability
purposes, implementers are strongly encouraged to consider implementing
the recommendations described in <a href="#recommended-security-mechanisms">Recommended security mechanisms</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="example-of-solutions">6.2. Example of solutions</h3>
<div class="paragraph">
<p>The following paragraphs give a brief overview of possible solutions
that address the 4 security requirements of the CTP API, for
informational purposes only.</p>
</div>
<div class="paragraph">
<p>Currently, the most straightforward way to implement requirement 2 is
the use of SSL/TLS, with a server-side certificate.</p>
</div>
<div class="paragraph">
<p>Requirement 1 implies that the client is identified and authenticated.
Identification allows distinguishing one client from another (e.g. a
user name), while authentication is used to ascertain the claimed
identity (e.g. a password).</p>
</div>
<div class="paragraph">
<p>Clients can be identified through several means, for example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Each client can be assigned a different <code>{CTPBase}</code> <a href="#api-resources-urls">URL</a>.
(e.g. cloud service customer “foo” accesses the CTP server through
<a href="http://example.com/ctp/foo/)">http://example.com/ctp/foo/)</a>.</p>
</li>
<li>
<p>Each client can be identified as part of an underlying
authentication mechanism through a “user name” (e.g. HTTP BASIC or
DIGEST access).</p>
</li>
<li>
<p>Each client can be implicitly identified and authenticated
simultaneously through a security token provided in an HTTP header (e.g.
such as in OAuth2 token placed in an <code>Authorization:</code> header).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Clients can be authenticated by several means. In simple scenarios,
client authentication can be performed with traditional HTTP
authentication (BASIC) over SSL/TLS. For more advanced
scenarios, stronger security is provided with mechanisms such as OAuth
and other security-token based approaches.</p>
</div>
<div class="paragraph">
<p>All the above mechanisms also typically satisfy requirements 3 and 4. They do
not require the CTP server to maintain any state between two consecutive
API calls. They do not require modification of the API.</p>
</div>
</div>
<div class="sect2">
<h3 id="recommended-security-mechanisms">6.3. Recommended security mechanisms</h3>
<div class="paragraph">
<p>In order to promote interoperability, both CTP clients and servers
SHOULD consider implementing the following solution based on OAuth2
and TLS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All communications MUST take place over TLS version 1.2 or above,
with a server side certificate, using current best practice
approaches <span class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnote_6" title="View footnote.">6</a>]</span>.</p>
</li>
<li>
<p>CTP client requests MUST be authenticated with a securely generated OAuth2 "bearer"
token as defined in <a href="#RFC_6750">[RFC_6750]</a>, transmitted in the HTTP "Authorization"
header of the request.</p>
</li>
<li>
<p>If a CTP client attempts to access a CTP Resource without providing
an access token or if the token is incorrect, the CTP server MUST respond
with a <code>WWW-Authenticate</code> header containing a <code>scope</code> field set to the value
<code>CTP API 1.0</code>. CTP clients MAY use the presence of this field to detect the
implementation of the security mechanism recommended in this section. CTP
server MUST NOT set this field to the value defined above if they do not
implement the security mechanism defined in this section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The acquisition and the renewal of the OAuth2 "bearer" should be conducted
according to the OAuth2 framework (See <a href="#RFC_6749">[RFC_6749]</a>), and is out of scope
of this document.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Let <code>vaikoh6gahJeekoovaiphiad</code> represent a OAuth2 bearer
token, the following command shows a secure GET request to the URL
<code>https://ctp.example.com/assets/02</code> using curl, a widely used command
line tool <a href="#CURL">[CURL]</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="bash language-bash">curl -s -H "Authorization: Bearer vaikoh6gahJeekoovaiphiad" https://ctp.example.com/assets/02/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CTP server will decode the header and extract the token.
The token is used both as an identifier and as an authenticator.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-examples">7. Appendix A: API Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides the transcript of a sample exchange between a CTP
client and a CTP server using the CTP API, as summarized in the
following sequence diagram.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="media/sequence-diagram.png" alt="image"></span></p>
</div>
<div class="paragraph">
<p>This CTP exchange between a client and a CTP server, starts from the
connection to the CTP entry point and includes the discovery of
service-views, cloud resources, security attributes, measurements and
the creation of a trigger.</p>
</div>
<div class="paragraph">
<p>In the examples, the CTP entry point <code>{CtpBase}</code> is
<code>https://ctp.cloudsecurityalliance.org/ctp</code>.</p>
</div>
<div class="paragraph">
<p>For the sake of simplicity the following examples do not describe the
underlying security exchanges (SSL/TLS) nor the
identification/authentication of the client.</p>
</div>
<div class="sect2">
<h3 id="step-1">7.1. Step 1: Connecting to the entry point of the CTP server</h3>
<div class="paragraph">
<p>As a starting point a cloud service customer using CTP will likely
connect to the CTP entry point, where he can obtain information on the
version of CTP that is running as well as a pointer to a collection of
service units that are under the supervision of this CTP server.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/ HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/",
  "name": "ikialab cloud service",
  "annotation": "This is the CTP server of Ikialab.net",
  "version": "0",
  "provider": "net.ikialab",
  "views": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews",
  "metrics": "https://ctp.cloudsecurityalliance.org/ctp/metrics"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-2">7.2. Step 2: Discovering the service-views accessible to the customer</h3>
<div class="paragraph">
<p>The previous query returned a link to the collection of service-views exposed to the customer
(<code>https://ctp.cloudsecurityalliance.org/ctp/serviceViews</code>). We can access this collection by issuing a
GET request.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/serviceViews HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/",
  "collectionLength": 1,
  "returnedLength": 1,
  "collectionType": "views",
  "collection": [
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ",
        "name": "main"
    }
  ]
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-3">7.3. Step 3: Accessing information on the service-view</h3>
<div class="paragraph">
<p>The previous example showed that the customer has only access to one service-view. We
can now query the corresponding service-view for further details.</p>
</div>
<div class="paragraph">
<p>The response tells us about the
provider responsible for the service unit, provides references to the
dependencies of the service unit and its service resources. We note that
no <a href="#classes">service class</a> is specified.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/",
  "name": "main",
  "annotation": "The main service-view provided to the customer",
  "provider": "net.ikialab",
  "dependencies": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/dependencies",
  "assets": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/assets",
  "serviceClass": "",
  "logs": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/logs",
  "triggers": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/triggers"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-4">7.4. Step 4: Discovering the list of assets of the service-view</h3>
<div class="paragraph">
<p>We can now query the list of assets that are part of the
service-view. The query returns a list of 4 references to assets.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/assets HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...
{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ/assets",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ",
  "collectionLength": 4,
  "returnedLength": 4,
  "collectionType": "assets",
  "collection": [
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU",
        "name": "https://webserver.example.com"
    },
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fha1",
        "name": "https://database.example.com"
    },
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fha2"
    },
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fha3"
    }
  ]
}
</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-5">7.5. Step 5: Discovering the details of the first asset of the service-view</h3>
<div class="paragraph">
<p>We now query information about the first asset in the group
of 4 we previously discovered. The response to the query provides us
with a reference to the collection of security attributes that apply to
this cloud asset (In this example, there is no <a href="#classes">asset class</a>
applicable to this cloud asset). We learn that the
name of the asset is <code>"https://webserver.example.com/"</code>,
which seems to identify a SSL/TLS server.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/serviceViews/VIYQUT1WG628fhbQ",
  "name": "https://webserver.example.com",
  "annotation": "Webserver running on Linux Ubuntu (apache)",
  "attributes": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU/attributes",
  "assetClass": ""
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-6">7.6. Step 8: Discovering the list of security attributes of the asset</h3>
<div class="paragraph">
<p>We now obtain a collection of references to security attributes that
apply to this asset, using the &#8220;collection&#8221; paradigm we have
already applied in some of the previous examples.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU/attributes HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU/attributes",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU",
  "collectionLength": 2,
  "returnedLength": 2,
  "collectionType": "attributes",
  "collection": [
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VIYQUT1WG628fhbV",
        "name": "availability"
    },
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu",
        "name": "confidentiality-of-access"
    }
  ]
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-7">7.7. Step 7: Discovering the details of the second security attribute of the asset</h3>
<div class="paragraph">
<p>We decide now to explore more in detail the second attribute of the
asset we have selected. The response notably shows us that the
security attribute offered here is “confidentiality-of-access” (which
could reference to the level of confidentiality of data in transit to
the asset previously identified as <code><a href="https://webserver.example.com/">https://webserver.example.com/</a></code>).</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/assets/VIYQUT1WG628fhbU",
  "name": "csa:confidentiatity:data-in-transit"
  "annotation": "confidentiality of data in transit with SSL/TLS",
  "name": "confidentiality-of-access",
  "measurements": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu/measurements"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-8">7.8. Step 8: Discovering the list of measurements available for this attribute.</h3>
<div class="paragraph">
<p>We now query how this attribute called “confidentiality-of-access” can
be measured. We find out that there is only one proposed measurement.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu/measurements HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu/measurements",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu",
  "collectionLength": 1,
  "returnedLength": 1,
  "collectionType": "measurements",
  "collection": [
    {
        "link": "https://ctp.cloudsecurityalliance.org/ctp/measurements/VWcIa-sfTYZSm6Qw"
    }
  ]
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-9">7.9. Step 9: Discovering the details of the first measurement available for the selected security attribute</h3>
<div class="paragraph">
<p>We now request more details on the one and only measurement that is
offered here for the attribute &#8220;confidentiality-of-access&#8221;. The response
is richer than in previous examples. We notably learn that the measurement is
based on a metric which further details by accessing the URL
<code>https://ctp.cloudsecurityalliance.org/ctp/metrics/VWcIa-sfTYZSm6Qv</code> as we will show
in the <a href="#step-10">next step</a>.</p>
</div>
<div class="paragraph">
<p>The response shows us that the current measurement of the “confidentiality-of-access” attribute of
the resource “https://webserver.example.com/” is 7, which corresponds to
the equivalent of a 128 bit key symmetric cryptographic algorithm,
according to the “ECRYPT II” scale referenced in the metric detailed in the <a href="#step-10">next step</a>. The
measurement result is dated form Jan 19<sup>th</sup> 2015 in this example.</p>
</div>
<div class="paragraph">
<p>The response also shows us
that the CSP is committed to maintaining a security level of at least
“7” for the attribute “confidentiality-of-access” as quantified with the
measurement. This is indicated by the expression
<code>value[0].level&gt;=7</code>.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/measurements/VWcIa-sfTYZSm6Qw HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/measurements/VWcIa-sfTYZSm6Qw",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/attributes/VWcIa-sfTYZSm6Qu",
  "name": ""
  "annotation": "",
  "metric": "https://ctp.cloudsecurityalliance.org/ctp/metrics/VWcIa-sfTYZSm6Qv",
  "result": {
    "value": [
      {
        "level": 7
      }
    ],
    "updateTime": "2015-05-28T15:22:03.674+03:00",
    "authorityId": "",
    "signature": ""
  },
  "objective": {
    "condition": "value[0].level&gt;=7",
    "status": "true"
  },
  "createTrigger": "",
  "userActivated": false,
  "state": "activated"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-10">7.10. Step 10: Getting information about the metric used in the measurement</h3>
<div class="paragraph">
<p>In the previous step, we only had a pointer to the metric used. By querying this
URL, we can now get more details on the metric used in the measurement. We notably
see that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The metric is defined in a &#8220;human readable&#8221; standard available at the (fictitious) URL <code>https://cloudsecurityalliance.org/ctp/metrics#csa:cryptographic-strength</code>.</p>
</li>
<li>
<p>The metric has one parameters: a scale, which is here the ECRYPT II scale (see <a href="http://www.keylength.com/en/3/)">http://www.keylength.com/en/3/)</a>.</p>
</li>
<li>
<p>The measurement result must be expressed as a number named "level".</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre>GET https://ctp.cloudsecurityalliance.org/ctp/metrics/VWcIa-sfTYZSm6Qv HTTP/1.1
...</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre>HTTP 200 OK
...

{
  "self": "https://ctp.cloudsecurityalliance.org/ctp/metrics/VWcIa-sfTYZSm6Qv",
  "scope": "https://ctp.cloudsecurityalliance.org/ctp/",
  "name": "cryptographic-strength",
  "annotation": "",
  "baseMetric": "https://cloudsecurityalliance.org/ctp/metrics#csa:cryptographic-strength",
  "measurementParameters": [
    {
      "name": "scale",
      "type": "string",
      "value": "ECRYPT II"
    }
  ],
  "resultFormat": [
    {
      "name": "level",
      "type": "number"
    }
  ]
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="supply-chain">8. Appendix B: Accessing information about the supply chain</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cloud services may depend on one or several others following a supply
chain model, in the case where a Cloud service customer is also a CSP,
which is taken into account in the design of CTP (e.g. when a SaaS
providers uses a third party IaaS provider). The overall security of the
service depends not only on the security of the cloud service provider
at the end of the supply chain but also on the security of third party
cloud service providers further down the supply chain.</p>
</div>
<div class="paragraph">
<p>Despite the fact that the security depends on several components in a
supply chain, the responsibility of reporting the security level of the
overall service remains on the shoulders of the “primary” CSP at the end
of the supply chain: the CSP that directly faces the cloud service
customer. It is the responsibility for this “primary” CSP to gain
assurance about the “secondary” CSPs involved in the supply chain,
possibly using CTP as well.</p>
</div>
<div class="paragraph">
<p>If the “primary” CSP uses CTP to exchange information with cloud service
customers, and if this “primary” CSP itself uses CTP to exchange data
with “secondary” CSPs, it may choose to “proxy” some information
originating from secondary CSPs back to the cloud service customer.</p>
</div>
<div class="paragraph">
<p>This proxy approach is useful in particular to automate the discovery by
the cloud service customer of all entities in the supply chain, through
direct exchanges with the “primary” CSP alone using the service-view
discovery API (See <a href="#service-views">dependencies</a>). Omitting some details (such as
cycle avoidance), this discovery would be conducted as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The client queries the Base URL of the “primary” CSP, and obtains
the name of the provider (see the “provider” property <a href="#get-ctpbase">here</a>).
Note that in practice the client is expected to know this
information already.</p>
</li>
<li>
<p>The client queries the “primary” CSP for the collection of all
service-views that are accessible to the client.</p>
</li>
<li>
<p>The client queries each <a href="#service-views">service-view</a> in the collection, and builds a
graph representing the supply chain with the following information:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Each service-view contains a pointer to a collection of dependencies, where each
dependencies is itself a service-views that is added to the list of service-views to query.</p>
</li>
<li>
<p>Third party providers in dependencies are identified by the fact that the “provider”
field in the service-view is different from the one collected in point 1
as part of the Base URL.</p>
</li>
<li>
<p>Links between providers can be established by walking through the
collection of dependencies (see the “dependencies” field in the
service-view)</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the above discovery process, the “primary” CSP will forward queries
regarding third party Service-views down the supply chain and will relay
back responses to the client. In most cases, these queries can be
“cached” by the cloud provider since the supply chain is expected to
change infrequently.</p>
</div>
<div class="paragraph">
<p>The information that is provided by the &#8220;secondary CSPs&#8221; in the supply chain
does not have to include &#8220;assets&#8221;, &#8220;attributes&#8221; or &#8220;measurements&#8221;. While the
primary CSP is expected to provide all possible elements, the secondary CSPs are
only expected to provide a description of sevice-views and their dependencies, for
the sole purpose of describing the supply chain.</p>
</div>
<div class="paragraph">
<p>Providing visibility on the supply chain is often considered as a
compliance requirement for CSPs with regards to EU data protection
rules. CTP’s Service-view discovery API could make this process
automatic.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ctp-project-history">9. Appendix C: CTP project history</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>The following paragraphs are mainly intended for readers familiar with
previous versions of CTP or who want an overview of the CTP project
status.</em></p>
</div>
<div class="paragraph">
<p>The principles of the Cloud Trust Protocol were defined by CSC in 2010
in “<a href="#CTP2">A precis for the cloudtrust protocol (v 2.0)</a>”, hereafter
referred to simply as “CTP 2.0”. The goal of this work is to contribute
to the advancement of CTP from the abstract framework defined in CTP 2.0
to the specification of an implementable protocol, hereafter referred as
“CTP 3.0”. To achieve this, the work on CTP 3.0 has been divided into
the following tasks or deliverables:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Overview of the CTP Version 3.0</p>
</li>
<li>
<p>CTP Reference Specification of the Elements of Transparency (EoTs)</p>
</li>
<li>
<p>CTP Business Use Cases</p>
</li>
<li>
<p>CTP Technical Model and API</p>
</li>
<li>
<p>CTP Integration in the GRC Stack</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This document is a proposal of a <strong>CTP Technical Model and API</strong>.
Security attributes manipulated by the CTP API are specified in a
separate document.</p>
</div>
<div class="paragraph">
<p>Some of key differences between CTP 2.0 and CTP 3.0 can be summarized as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>“Security attributes” instead of “Elements of Transparency” as
building blocks</em>: From a high level perspective, the CTP 2.0
architecture classifies the information exchanged between a cloud
service customer and a cloud provider in broad categories called
“Elements of Transparency” (EoT), such as for example “Alerts”,
“Provider capabilities and service claims” or “Results of latest
vulnerability assessment”. From a technical perspective, these Elements
of Transparency need to be implemented through a concrete set of
mechanisms in association with a relevant data model. This document
focuses on “security attributes” as a fundamental building block of the
CTP API data model. Most, but not all, Elements of Transparency
envisioned in CTP 2.0 can be translated in a set of security attributes,
whose values will be queried by the cloud service customer. The use of
word “attribute” also aims to better align CTP with the terminology of
ISO/IEC 27000.</p>
</li>
<li>
<p><em>Providing a separation between mechanisms and content</em>: In CTP 2.0,
elements of transparency encompass both mechanisms and content. CTP 3.0
attempts to provide a clear distinction between security attributes and
mechanisms (e.g. “availability” versus “creating triggers”).</p>
</li>
<li>
<p><em>Minimizing dependencies on external standards</em>: CTP 2.0 relies
heavily on SCAP as a foundation while CTP 3.0 is designed to be
implementable on a standalone basis, with dependencies only on simple
standards such JSON and several RFCs.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references">10. References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="CTP2"></a>[CTP2] Ron Knode, Doug Egan. <em>A precis for the cloudtrust protocol (v2.0)</em>. CSC, July 2010.</p>
</li>
<li>
<p><a id="ENISA"></a>[ENISA] European Union Agency for Network and Information Security, <em>Glossary</em>,
<a href="https://www.enisa.europa.eu/activities/risk-management/current-risk/risk-management-inventory/glossary">https://www.enisa.europa.eu/activities/risk-management/current-risk/risk-management-inventory/glossary</a></p>
</li>
<li>
<p><a id="ECMA_262"></a>[ECMA_262] ECMA International. <em>ECMAScript Language Specification, 5.1 edition</em>. June 2011. Available at
<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf">http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf</a></p>
</li>
<li>
<p><a id="ISO_27000"></a>[ISO_27000] ISO/IEC. <em>ISO/IEC 27000:2014 Information technology&#8201;&#8212;&#8201;Security
techniques&#8201;&#8212;&#8201;Information security management systems&#8201;&#8212;&#8201;Overview and
vocabulary</em>. Published.</p>
</li>
<li>
<p><a id="ISO_19086"></a>[ISO_19086] ISO/IEC. <em>ISO/IEC CD 19086-1 Information technology&#8201;&#8212;&#8201;Cloud
computing&#8201;&#8212;&#8201;Service level agreement (SLA) framework and Technology&#8201;&#8212;&#8201;Part 1: Overview and concepts</em>. Under development.</p>
</li>
<li>
<p><a id="NIST"></a>[NIST] NIST, <em>Cloud Computing Service Metrics Description</em>. Special
Publication 500-307, NIST Cloud Computing Reference Architecture and
Taxonomy Working Group, DRAFT.</p>
</li>
<li>
<p><a id="RFC_4648"></a>[RFC_4648] S. Josefsson. <em>RFC 4648: The Base16, Base32, and Base64 Data
Encodings</em>. The Internet Engineering Task Force, October 2006.</p>
</li>
<li>
<p><a id="RFC_2119"></a>[RFC_2119] S. Bradner. <em>RFC 2119: Key words for use in RFCs to Indicate
Requirement Levels</em>. The Internet Engineering Task Force, March 1997.</p>
</li>
<li>
<p><a id="RFC_6120"></a>[RFC_6120] P. Saint-Andre, <em>RFC 6120: Extensible Messaging and Presence
Protocol (XMPP): Core</em>. The Internet Engineering Task Force, March 2011.</p>
</li>
<li>
<p><a id="RFC_3986"></a>[RFC_3986] T. Berners-Lee, R. Fielding, L. Masinter. <em>RFC 3986: Uniform
Resource Identifier (URI): Generic Syntax</em>. The Internet Engineering
Task Force, January 2005.</p>
</li>
<li>
<p><a id="RFC_7515"></a>[RFC_7515] M. Jones, J. Bradley, N. Sakimura. <em>RFC 7515: JSON Web
Signature (JWS)</em>. The Internet Engineering Task Force, May 2015.</p>
</li>
<li>
<p><a id="CURL"></a>[CURL] <em>curl, a command line tool and library for transferring data with
URL syntax</em>. Available at <a href="http://curl.haxx.se/">http://curl.haxx.se/</a></p>
</li>
<li>
<p><a id="RFC_2617"></a>[RFC_2617] J. Franks, P. Hallam-Baker, J. Hostetler, S. Lawrence, P.
Leach, A. Luotonen, L. Stewart. <em>RFC 2617: HTTP Authentication: Basic and Digest
Access Authentication</em>. The Internet Engineering Task Force, June 1999.</p>
</li>
<li>
<p><a id="RFC_6749"></a>[RFC_6749] D. Hardt, Ed. <em>The OAuth 2.0 Authorization Framework</em>,
Internet Engineering Task Force (IETF), October 2012.</p>
</li>
<li>
<p><a id="RFC_6750"></a>[RFC_6750] M. Jones, D. Hardt, <em>RFC 6750: The OAuth 2.0 Authorization Framework:
Bearer Token Usage</em>, Internet Engineering Task Force (IETF), October 2012.</p>
</li>
<li>
<p><a id="RFC_3339"></a>[RFC_3339] G. Klyne, C. Newman, <em>RFC 3339: Date and Time on the Internet: Timestamps</em>
Internet Engineering Task Force (IETF), July 2002.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. REST describes the
Representational state transfer, a common approach for modern web
services, see <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm</a>
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. This is a
simplistic measurement process for confidentiality, used illustrative
purposes only. This process would need to be more specifically detailed
in an associated metric.
</div>
<div class="footnote" id="_footnote_3">
<a href="#_footnoteref_3">3</a>. To be accurate this expression should be written as
“value[0\].key_length&gt;=192” in CTP and use a better scale than bit length.
</div>
<div class="footnote" id="_footnote_4">
<a href="#_footnoteref_4">4</a>. Note, to address a point of potential
confusion: in order to be able to make statements about “security
attributes”, we include “attribute” as a class in our model. As a
consequence, if we adopt UML terminology, the 3 elements that define a
security attribute can therefore be considered as “UML attributes” of
“security attributes”.
</div>
<div class="footnote" id="_footnote_5">
<a href="#_footnoteref_5">5</a>. <a href="http://pubs.opengroup.org/onlinepubs/009696899/basedefs/xbd_chap09.html">http://pubs.opengroup.org/onlinepubs/009696899/basedefs/xbd_chap09.html</a>
</div>
<div class="footnote" id="_footnote_6">
<a href="#_footnoteref_6">6</a>. For example
<a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.13<br>
Last updated 2015-10-12 15:43:12 EEST
</div>
</div>
</body>
</html>